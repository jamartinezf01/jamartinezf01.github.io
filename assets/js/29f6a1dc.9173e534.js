"use strict";(self.webpackChunkp_my_dm=self.webpackChunkp_my_dm||[]).push([[5597],{71663:(e,a,s)=>{s.r(a),s.d(a,{assets:()=>o,contentTitle:()=>d,default:()=>u,frontMatter:()=>l,metadata:()=>n,toc:()=>c});const n=JSON.parse('{"id":"aplicaciones m\xf3viles/5 Persistencia/FireBase/Real Time Database/reglas de seguridad","title":"Reglas de Seguridad","description":"Las Reglas de Seguridad de Firebase Realtime Database te permiten controlar de forma declarativa qui\xe9n puede leer, escribir o realizar operaciones m\xe1s avanzadas en tu base de datos. Estas reglas se basan en la informaci\xf3n de autenticaci\xf3n del usuario (auth) y en la estructura de los datos, lo que te facilita restringir el acceso de acuerdo a la l\xf3gica de tu aplicaci\xf3n. Con un buen dominio de las reglas, te asegurar\xe1s de que tu aplicaci\xf3n sea segura y de que cada usuario solo acceda a la informaci\xf3n a la que deba tener derecho.","source":"@site/docs/aplicaciones m\xf3viles/5 Persistencia/FireBase/Real Time Database/reglas de seguridad.md","sourceDirName":"aplicaciones m\xf3viles/5 Persistencia/FireBase/Real Time Database","slug":"/aplicaciones m\xf3viles/5 Persistencia/FireBase/Real Time Database/reglas de seguridad","permalink":"/docs/aplicaciones m\xf3viles/5 Persistencia/FireBase/Real Time Database/reglas de seguridad","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":8,"frontMatter":{"sidebar_position":8},"sidebar":"movilesSidebar","previous":{"title":"Soporte OffLine","permalink":"/docs/aplicaciones m\xf3viles/5 Persistencia/FireBase/Real Time Database/soporte offline"},"next":{"title":"Ejemplo Tabl\xf3n de Anuncios","permalink":"/docs/aplicaciones m\xf3viles/5 Persistencia/FireBase/Real Time Database/Ejemplo Tabl\xf3n de Anuncios"}}');var r=s(74848),i=s(28453);const l={sidebar_position:8},d="Reglas de Seguridad",o={},c=[{value:"1. <strong>D\xf3nde se Definen las Reglas</strong>",id:"1-d\xf3nde-se-definen-las-reglas",level:2},{value:"2. <strong>C\xf3mo Funcionan las Condiciones</strong>",id:"2-c\xf3mo-funcionan-las-condiciones",level:2},{value:"3. <strong>Ejemplos de Reglas Comunes</strong>",id:"3-ejemplos-de-reglas-comunes",level:2},{value:"Solo usuarios autenticados pueden leer y escribir en toda la base de datos:",id:"solo-usuarios-autenticados-pueden-leer-y-escribir-en-toda-la-base-de-datos",level:3},{value:"Leer datos de forma p\xfablica, pero solo usuarios autenticados pueden escribir:",id:"leer-datos-de-forma-p\xfablica-pero-solo-usuarios-autenticados-pueden-escribir",level:3},{value:"Reglas espec\xedficas para diferentes nodos:",id:"reglas-espec\xedficas-para-diferentes-nodos",level:3},{value:"4. <strong>Validaci\xf3n de Datos</strong>",id:"4-validaci\xf3n-de-datos",level:2},{value:"5. <strong>Prueba de Reglas</strong>",id:"5-prueba-de-reglas",level:2},{value:"<strong>Buenas Pr\xe1cticas</strong>",id:"buenas-pr\xe1cticas",level:2},{value:"<strong>Diagrama</strong>",id:"diagrama",level:2}];function t(e){const a={a:"a",admonition:"admonition",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(a.header,{children:(0,r.jsx)(a.h1,{id:"reglas-de-seguridad",children:"Reglas de Seguridad"})}),"\n",(0,r.jsxs)(a.p,{children:["Las ",(0,r.jsx)(a.strong,{children:"Reglas de Seguridad"})," de Firebase Realtime Database te permiten controlar de forma declarativa qui\xe9n puede ",(0,r.jsx)(a.strong,{children:"leer"}),", ",(0,r.jsx)(a.strong,{children:"escribir"})," o realizar operaciones m\xe1s avanzadas en tu base de datos. Estas reglas se basan en la informaci\xf3n de autenticaci\xf3n del usuario (",(0,r.jsx)(a.code,{children:"auth"}),") y en la estructura de los datos, lo que te facilita restringir el acceso de acuerdo a la l\xf3gica de tu aplicaci\xf3n. Con un buen dominio de las reglas, te asegurar\xe1s de que tu aplicaci\xf3n sea segura y de que cada usuario solo acceda a la informaci\xf3n a la que deba tener derecho."]}),"\n",(0,r.jsxs)(a.h2,{id:"1-d\xf3nde-se-definen-las-reglas",children:["1. ",(0,r.jsx)(a.strong,{children:"D\xf3nde se Definen las Reglas"})]}),"\n",(0,r.jsxs)(a.p,{children:["En la ",(0,r.jsx)(a.strong,{children:"Consola de Firebase"}),", navega a ",(0,r.jsx)(a.strong,{children:"Build"})," \u2192 ",(0,r.jsx)(a.strong,{children:"Realtime Database"})," y busca la pesta\xf1a ",(0,r.jsx)(a.strong,{children:"Rules"}),". All\xed encontrar\xe1s un editor donde podr\xe1s escribir tus reglas en formato ",(0,r.jsx)(a.strong,{children:"JSON"}),"."]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-json",children:'{\r\n  "rules": {\r\n    ".read": "condition",\r\n    ".write": "condition"\r\n  }\r\n}\n'})}),"\n",(0,r.jsxs)(a.p,{children:["Tambi\xe9n puedes definir reglas m\xe1s espec\xedficas para cada ",(0,r.jsx)(a.strong,{children:"nodo"})," de la base de datos. Por ejemplo:"]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-json",children:'{\r\n  "rules": {\r\n    "anuncios": {\r\n      ".read": "auth != null",\r\n      ".write": "auth != null"\r\n    },\r\n    "usuarios": {\r\n      ".read": "auth != null",\r\n      ".write": "auth.uid === $uid"\r\n    }\r\n  }\r\n}\n'})}),"\n",(0,r.jsx)(a.admonition,{title:"En este ejemplo:",type:"info",children:(0,r.jsxs)(a.ul,{children:["\n",(0,r.jsxs)(a.li,{children:["Para la rama ",(0,r.jsx)(a.code,{children:"anuncios"}),", solo se permite la lectura y escritura a usuarios autenticados (",(0,r.jsx)(a.code,{children:"auth != null"}),")."]}),"\n",(0,r.jsxs)(a.li,{children:["Para la rama ",(0,r.jsx)(a.code,{children:"usuarios"}),", solo se permite la lectura a usuarios autenticados, y la escritura \xfanicamente se concede si el ",(0,r.jsx)(a.code,{children:"uid"})," del usuario autenticado coincide con el nodo en la base de datos (",(0,r.jsx)(a.code,{children:"$uid"})," se refiere al nombre del nodo). Este tipo de regla se usa, por ejemplo, para que cada usuario solo pueda escribir en su propio perfil."]}),"\n"]})}),"\n",(0,r.jsxs)(a.h2,{id:"2-c\xf3mo-funcionan-las-condiciones",children:["2. ",(0,r.jsx)(a.strong,{children:"C\xf3mo Funcionan las Condiciones"})]}),"\n",(0,r.jsxs)(a.p,{children:["En cada propiedad (",(0,r.jsx)(a.code,{children:".read"}),", ",(0,r.jsx)(a.code,{children:".write"}),", etc.), puedes usar ",(0,r.jsx)(a.strong,{children:"expresiones booleanas"})," que devuelven ",(0,r.jsx)(a.code,{children:"true"})," o ",(0,r.jsx)(a.code,{children:"false"}),". Entre las variables y funciones m\xe1s habituales est\xe1n:"]}),"\n",(0,r.jsxs)(a.ul,{children:["\n",(0,r.jsxs)(a.li,{children:["\n",(0,r.jsxs)(a.p,{children:[(0,r.jsx)(a.strong,{children:(0,r.jsx)(a.code,{children:"auth"})}),": Objeto que representa la informaci\xf3n de autenticaci\xf3n del usuario (cuando el usuario est\xe1 autenticado). Si el usuario no est\xe1 autenticado, ",(0,r.jsx)(a.code,{children:"auth"})," ser\xe1 ",(0,r.jsx)(a.code,{children:"null"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(a.li,{children:["\n",(0,r.jsxs)(a.p,{children:[(0,r.jsx)(a.strong,{children:(0,r.jsx)(a.code,{children:"auth.uid"})}),": ID \xfanico del usuario que inicia sesi\xf3n con Firebase Authentication."]}),"\n"]}),"\n",(0,r.jsxs)(a.li,{children:["\n",(0,r.jsxs)(a.p,{children:[(0,r.jsx)(a.strong,{children:(0,r.jsx)(a.code,{children:"$variable"})}),": Par\xe1metros en la ruta que permiten reglas din\xe1micas.",(0,r.jsx)(a.br,{}),"\n","Por ejemplo, si tu regla est\xe1 en ",(0,r.jsx)(a.code,{children:"usuarios/$uid"}),", la variable ",(0,r.jsx)(a.code,{children:"$uid"})," tomar\xe1 el valor de cada nodo hijo en ",(0,r.jsx)(a.code,{children:"usuarios"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(a.li,{children:["\n",(0,r.jsxs)(a.p,{children:[(0,r.jsx)(a.strong,{children:"Operadores l\xf3gicos"}),": ",(0,r.jsx)(a.code,{children:"&&"})," (AND), ",(0,r.jsx)(a.code,{children:"||"})," (OR), ",(0,r.jsx)(a.code,{children:"!"})," (NOT), entre otros."]}),"\n"]}),"\n",(0,r.jsxs)(a.li,{children:["\n",(0,r.jsxs)(a.p,{children:[(0,r.jsx)(a.strong,{children:"Otras funciones"}),": Por ejemplo, ",(0,r.jsx)(a.code,{children:"root.child('path').val()"}),", ",(0,r.jsx)(a.code,{children:"now"}),", ",(0,r.jsx)(a.code,{children:"newData"}),", ",(0,r.jsx)(a.code,{children:"data"}),", etc., para reglas avanzadas."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(a.admonition,{type:"info",children:(0,r.jsxs)(a.p,{children:["Para saber m\xe1s sobre las reglas de seguridad visita la ",(0,r.jsx)(a.a,{href:"https://firebase.google.com/docs/database/security/get-started?hl=es&authuser=0&_gl=1*1jt0rf7*_ga*MTY3OTA3MDk1MS4xNzI5NDEwODIz*_ga_CW55HF8NVT*MTczODQ5NzE1Ny4yMS4xLjE3Mzg0OTc2MzQuMC4wLjA.",children:"Documentaci\xf3n de Firebase"})]})}),"\n",(0,r.jsxs)(a.h2,{id:"3-ejemplos-de-reglas-comunes",children:["3. ",(0,r.jsx)(a.strong,{children:"Ejemplos de Reglas Comunes"})]}),"\n",(0,r.jsx)(a.h3,{id:"solo-usuarios-autenticados-pueden-leer-y-escribir-en-toda-la-base-de-datos",children:"Solo usuarios autenticados pueden leer y escribir en toda la base de datos:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-json",children:'{\r\n  "rules": {\r\n    ".read": "auth != null",\r\n    ".write": "auth != null"\r\n  }\r\n}\n'})}),"\n",(0,r.jsx)(a.admonition,{title:"Explicaci\xf3n",type:"note",children:(0,r.jsxs)(a.ul,{children:["\n",(0,r.jsxs)(a.li,{children:[(0,r.jsx)(a.code,{children:"auth != null"})," significa que se requiere un usuario autenticado."]}),"\n"]})}),"\n",(0,r.jsx)(a.h3,{id:"leer-datos-de-forma-p\xfablica-pero-solo-usuarios-autenticados-pueden-escribir",children:"Leer datos de forma p\xfablica, pero solo usuarios autenticados pueden escribir:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-json",children:'{\r\n  "rules": {\r\n    ".read": true,\r\n    ".write": "auth != null"\r\n  }\r\n}\n'})}),"\n",(0,r.jsx)(a.admonition,{title:"Explicaci\xf3n",type:"note",children:(0,r.jsxs)(a.ul,{children:["\n",(0,r.jsxs)(a.li,{children:[(0,r.jsx)(a.code,{children:'".read": true'})," significa acceso de lectura abierto a todos."]}),"\n",(0,r.jsxs)(a.li,{children:[(0,r.jsx)(a.code,{children:'".write": "auth != null"'})," restringe las escrituras a usuarios registrados."]}),"\n"]})}),"\n",(0,r.jsx)(a.h3,{id:"reglas-espec\xedficas-para-diferentes-nodos",children:"Reglas espec\xedficas para diferentes nodos:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-json",children:'{\r\n  "rules": {\r\n    "perfiles": {\r\n      "$uid": {\r\n        // Permite solo al usuario due\xf1o de este perfil leer/escribir\r\n        ".read": "auth != null && auth.uid === $uid",\r\n        ".write": "auth != null && auth.uid === $uid"\r\n      }\r\n    },\r\n    "mensajesPublicos": {\r\n      // Lectura abierta a todos, escritura solo a usuarios registrados\r\n      ".read": true,\r\n      ".write": "auth != null"\r\n    }\r\n  }\r\n}\n'})}),"\n",(0,r.jsx)(a.admonition,{type:"info",children:(0,r.jsxs)(a.ul,{children:["\n",(0,r.jsxs)(a.li,{children:["Cada rama (",(0,r.jsx)(a.code,{children:"perfiles"}),", ",(0,r.jsx)(a.code,{children:"mensajesPublicos"}),") tiene reglas propias."]}),"\n",(0,r.jsxs)(a.li,{children:["En ",(0,r.jsx)(a.code,{children:"perfiles/$uid"}),", se verifica que ",(0,r.jsx)(a.code,{children:"auth.uid"})," sea igual al ",(0,r.jsx)(a.code,{children:"$uid"})," del nodo para dar acceso."]}),"\n"]})}),"\n",(0,r.jsxs)(a.h2,{id:"4-validaci\xf3n-de-datos",children:["4. ",(0,r.jsx)(a.strong,{children:"Validaci\xf3n de Datos"})]}),"\n",(0,r.jsxs)(a.p,{children:["Adem\xe1s de permitir o denegar acceso, las reglas tambi\xe9n pueden ",(0,r.jsx)(a.strong,{children:"validar"})," la estructura y el tipo de los datos que se escriben. Por ejemplo, si quieres asegurar que en ",(0,r.jsx)(a.code,{children:"anuncios"})," cada nodo tenga la propiedad ",(0,r.jsx)(a.code,{children:"titulo"})," de tipo cadena y un ",(0,r.jsx)(a.code,{children:"mensaje"})," tambi\xe9n de tipo cadena, puedes usar:"]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-json",children:'{\r\n  "rules": {\r\n    "anuncios": {\r\n      "$anuncioId": {\r\n        ".write": "auth != null",\r\n        "titulo": {\r\n          ".validate": "newData.isString() && newData.val().length > 0"\r\n        },\r\n        "mensaje": {\r\n          ".validate": "newData.isString() && newData.val().length > 0"\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\n'})}),"\n",(0,r.jsx)(a.admonition,{title:"En este ejemplo:",type:"info",children:(0,r.jsxs)(a.ul,{children:["\n",(0,r.jsxs)(a.li,{children:[(0,r.jsx)(a.code,{children:'".validate"'})," verifica la estructura y el contenido del nodo:","\n",(0,r.jsxs)(a.ul,{children:["\n",(0,r.jsxs)(a.li,{children:[(0,r.jsx)(a.code,{children:"newData.isString()"})," obliga a que los valores sean cadenas."]}),"\n",(0,r.jsxs)(a.li,{children:[(0,r.jsx)(a.code,{children:"newData.val().length > 0"})," obliga a que no est\xe9n vac\xedas."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(a.li,{children:"Si la validaci\xf3n falla, la escritura se rechaza autom\xe1ticamente."}),"\n"]})}),"\n",(0,r.jsxs)(a.h2,{id:"5-prueba-de-reglas",children:["5. ",(0,r.jsx)(a.strong,{children:"Prueba de Reglas"})]}),"\n",(0,r.jsxs)(a.p,{children:["Para asegurarte de que tus reglas est\xe1n configuradas correctamente, utiliza la ",(0,r.jsx)(a.strong,{children:"pesta\xf1a \u201cRules\u201d \u2192 \u201cTest Rules\u201d"})," en la consola de Firebase. All\xed puedes simular lecturas/escrituras (pasando un ",(0,r.jsx)(a.code,{children:"uid"})," o sin \xe9l) para ver si se permitir\xeda o denegar\xeda el acceso."]}),"\n",(0,r.jsxs)(a.p,{children:["Tambi\xe9n puedes usar la ",(0,r.jsx)(a.strong,{children:"Firebase CLI"})," con el comando ",(0,r.jsx)(a.code,{children:"firebase emulators:start --only database"})," y luego escribir reglas en tiempo real, probar lecturas/escrituras con requests locales o usar el ",(0,r.jsx)(a.strong,{children:"Emulator UI"})," para verificar el comportamiento de las reglas sin riesgo de alterar la base de datos en producci\xf3n."]}),"\n",(0,r.jsx)(a.h2,{id:"buenas-pr\xe1cticas",children:(0,r.jsx)(a.strong,{children:"Buenas Pr\xe1cticas"})}),"\n",(0,r.jsx)(a.admonition,{title:"sigue estas reglas",type:"tip",children:(0,r.jsxs)(a.ol,{children:["\n",(0,r.jsxs)(a.li,{children:[(0,r.jsx)(a.strong,{children:"Principio de Privilegios M\xednimos"}),": Permite solo lo necesario. Evita reglas demasiado abiertas como ",(0,r.jsx)(a.code,{children:'".read": true, ".write": true'}),"."]}),"\n",(0,r.jsxs)(a.li,{children:[(0,r.jsx)(a.strong,{children:"Separar Ramas Sensibles"}),": Si tienes datos que requieren protecci\xf3n adicional (p.ej. datos personales, contrase\xf1as cifradas, etc.), ponlos en una rama con reglas m\xe1s estrictas."]}),"\n",(0,r.jsxs)(a.li,{children:[(0,r.jsx)(a.strong,{children:"Validaci\xf3n"}),": Adem\xe1s de restringir acceso, aprovecha las reglas para validar el formato de los datos. Esto reduce errores y abusos."]}),"\n",(0,r.jsxs)(a.li,{children:[(0,r.jsx)(a.strong,{children:"Autenticaci\xf3n"}),": Combinar ",(0,r.jsx)(a.code,{children:"auth != null"})," con validaci\xf3n de ",(0,r.jsx)(a.code,{children:"auth.uid"})," es clave para asociar datos a usuarios concretos."]}),"\n",(0,r.jsxs)(a.li,{children:[(0,r.jsx)(a.strong,{children:"Testing y Emuladores"}),": Antes de desplegar reglas a producci\xf3n, pru\xe9balas localmente con el emulador o la secci\xf3n ",(0,r.jsx)(a.strong,{children:"Test Rules"})," de la consola."]}),"\n"]})}),"\n",(0,r.jsx)(a.hr,{}),"\n",(0,r.jsx)(a.h2,{id:"diagrama",children:(0,r.jsx)(a.strong,{children:"Diagrama"})}),"\n",(0,r.jsx)(a.mermaid,{value:"flowchart TD\r\n    A[Solicitud de Lectura/Escritura] --\x3e B[\xbfExiste regla para el nodo?]\r\n    B -- No --\x3e C[Se aplican reglas padre o ancestro]\r\n    B -- S\xed --\x3e D[La condici\xf3n eval\xfaa true/false]\r\n    D -- True --\x3e E[Permitir operaci\xf3n]\r\n    D -- False --\x3e F[Denegar operaci\xf3n]"}),"\n",(0,r.jsxs)(a.ol,{children:["\n",(0,r.jsxs)(a.li,{children:["Una ",(0,r.jsx)(a.strong,{children:"solicitud"})," de lectura o escritura llega a la base de datos."]}),"\n",(0,r.jsxs)(a.li,{children:["Se ",(0,r.jsx)(a.strong,{children:"buscan"})," reglas espec\xedficas para el nodo en cuesti\xf3n. Si no las hay, se buscan en el ancestro inmediato (subiendo hasta la ra\xedz)."]}),"\n",(0,r.jsxs)(a.li,{children:["La ",(0,r.jsx)(a.strong,{children:"condici\xf3n"})," (por ejemplo ",(0,r.jsx)(a.code,{children:"auth != null && auth.uid === $uid"}),") se eval\xfaa."]}),"\n",(0,r.jsxs)(a.li,{children:[(0,r.jsx)(a.strong,{children:"Si"})," eval\xfaa a ",(0,r.jsx)(a.code,{children:"true"}),", se ",(0,r.jsx)(a.strong,{children:"permite"})," la operaci\xf3n; de lo contrario, se ",(0,r.jsx)(a.strong,{children:"deniega"}),"."]}),"\n"]}),"\n",(0,r.jsx)(a.hr,{})]})}function u(e={}){const{wrapper:a}={...(0,i.R)(),...e.components};return a?(0,r.jsx)(a,{...e,children:(0,r.jsx)(t,{...e})}):t(e)}},28453:(e,a,s)=>{s.d(a,{R:()=>l,x:()=>d});var n=s(96540);const r={},i=n.createContext(r);function l(e){const a=n.useContext(i);return n.useMemo((function(){return"function"==typeof e?e(a):{...a,...e}}),[a,e])}function d(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),n.createElement(i.Provider,{value:a},e.children)}}}]);