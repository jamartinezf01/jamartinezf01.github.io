"use strict";(self.webpackChunkp_my_dm=self.webpackChunkp_my_dm||[]).push([[3688],{8541:(e,i,o)=>{o.r(i),o.d(i,{assets:()=>d,contentTitle:()=>a,default:()=>h,frontMatter:()=>c,metadata:()=>n,toc:()=>t});const n=JSON.parse('{"id":"python/UT7 - Persistencia/7.2 Ficheros/7.2.5_poo_ficheros","title":"7.2.5 POO + Ficheros","description":"En proyectos reales no guardamos variables sueltas, guardamos objetos de dominio (Producto, Usuario, Pedido, etc.).","source":"@site/docs/python/UT7 - Persistencia/7.2 Ficheros/7.2.5_poo_ficheros.md","sourceDirName":"python/UT7 - Persistencia/7.2 Ficheros","slug":"/python/UT7 - Persistencia/7.2 Ficheros/7.2.5_poo_ficheros","permalink":"/docs/python/UT7 - Persistencia/7.2 Ficheros/7.2.5_poo_ficheros","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"sidebar_position":6},"sidebar":"pythonSidebar","previous":{"title":"7.2.4 Ficheros JSON","permalink":"/docs/python/UT7 - Persistencia/7.2 Ficheros/7.2.4_ficheros_json"},"next":{"title":"7.2.6 Manejo de Errores","permalink":"/docs/python/UT7 - Persistencia/7.2 Ficheros/7.2.6_manejo_errores"}}');var s=o(4848),r=o(8453);const c={sidebar_position:6},a="7.2.5 POO + Ficheros",d={},t=[{value:"<strong>1\ufe0f\u20e3 Por qu\xe9 combinar POO con persistencia</strong>",id:"1\ufe0f\u20e3-por-qu\xe9-combinar-poo-con-persistencia",level:2},{value:"<strong>2\ufe0f\u20e3 Patr\xf3n de transformaci\xf3n (<code>to_dict</code> / <code>from_dict</code>)</strong>",id:"2\ufe0f\u20e3-patr\xf3n-de-transformaci\xf3n-to_dict--from_dict",level:2},{value:"\ud83d\udfe9 Modelo de clase persistente",id:"-modelo-de-clase-persistente",level:3},{value:"\ud83d\udfe8 Comparativa r\xe1pida",id:"-comparativa-r\xe1pida",level:3},{value:"<strong>3\ufe0f\u20e3 Separaci\xf3n de responsabilidades: clase repositorio</strong>",id:"3\ufe0f\u20e3-separaci\xf3n-de-responsabilidades-clase-repositorio",level:2},{value:"\ud83d\udfe9 C\xf3mo se implementa un repositorio (paso a paso)",id:"-c\xf3mo-se-implementa-un-repositorio-paso-a-paso",level:3},{value:"\ud83d\udfe6 Repositorio b\xe1sico de inventario",id:"-repositorio-b\xe1sico-de-inventario",level:3},{value:"\ud83d\udfe8 Contrato recomendado del repositorio",id:"-contrato-recomendado-del-repositorio",level:3},{value:"\ud83d\udfe7 Ventaja arquitect\xf3nica",id:"-ventaja-arquitect\xf3nica",level:3},{value:"<strong>4\ufe0f\u20e3 Identificadores \xfanicos y consistencia de objetos</strong>",id:"4\ufe0f\u20e3-identificadores-\xfanicos-y-consistencia-de-objetos",level:2},{value:"\ud83d\udfe9 B\xfasqueda y actualizaci\xf3n por <code>sku</code>",id:"-b\xfasqueda-y-actualizaci\xf3n-por-sku",level:3},{value:"\ud83d\udfe6 Control b\xe1sico de alta duplicada",id:"-control-b\xe1sico-de-alta-duplicada",level:3},{value:"<strong>5\ufe0f\u20e3 Estrategias de guardado</strong>",id:"5\ufe0f\u20e3-estrategias-de-guardado",level:2},{value:"\ud83d\udfe9 Guardado por evento",id:"-guardado-por-evento",level:3},{value:"\ud83d\udfe6 Guardado al final",id:"-guardado-al-final",level:3},{value:"\ud83d\udfe8 Auto-guardado por lote",id:"-auto-guardado-por-lote",level:3},{value:"\ud83d\udfe7 Comparativa de estrategia",id:"-comparativa-de-estrategia",level:3},{value:"<strong>6\ufe0f\u20e3 Evoluci\xf3n de esquema y compatibilidad</strong>",id:"6\ufe0f\u20e3-evoluci\xf3n-de-esquema-y-compatibilidad",level:2},{value:"\ud83d\udfe9 Compatibilidad hacia atr\xe1s con valores por defecto",id:"-compatibilidad-hacia-atr\xe1s-con-valores-por-defecto",level:3},{value:"\ud83d\udfe6 Migraciones simples por versi\xf3n",id:"-migraciones-simples-por-versi\xf3n",level:3},{value:"<strong>7\ufe0f\u20e3 Ejemplo completo: servicio + repositorio</strong>",id:"7\ufe0f\u20e3-ejemplo-completo-servicio--repositorio",level:2},{value:"<strong>\u2705 Buenas pr\xe1cticas recomendadas</strong>",id:"-buenas-pr\xe1cticas-recomendadas",level:2},{value:"<strong>\ud83e\uddea Ejercicios pr\xe1cticos</strong> \u2013 Proyecto Atlas",id:"-ejercicios-pr\xe1cticos--proyecto-atlas",level:2},{value:"\ud83d\udfe2 Fase 1 \u2013 Modelo y carga inicial",id:"-fase-1--modelo-y-carga-inicial",level:3},{value:"\ud83d\udfe9 Ejercicio 1 \u2013 Clase <code>Producto</code> persistible",id:"-ejercicio-1--clase-producto-persistible",level:4},{value:"\ud83d\udfe6 Ejercicio 2 \u2013 Repositorio de inventario",id:"-ejercicio-2--repositorio-de-inventario",level:4},{value:"\ud83d\udfe1 Fase 2 \u2013 Operaciones de negocio",id:"-fase-2--operaciones-de-negocio",level:3},{value:"\ud83d\udfe8 Ejercicio 3 \u2013 Alta segura de productos",id:"-ejercicio-3--alta-segura-de-productos",level:4},{value:"\ud83d\udfe7 Ejercicio 4 \u2013 Aplicar movimientos de stock",id:"-ejercicio-4--aplicar-movimientos-de-stock",level:4},{value:"\ud83d\udd35 Fase 3 \u2013 Evoluci\xf3n de esquema",id:"-fase-3--evoluci\xf3n-de-esquema",level:3},{value:"\ud83d\udfe5 Ejercicio 5 \u2013 Cargar datos legacy",id:"-ejercicio-5--cargar-datos-legacy",level:4},{value:"\ud83d\udfeb Ejercicio 6 \u2013 Migraci\xf3n con versi\xf3n",id:"-ejercicio-6--migraci\xf3n-con-versi\xf3n",level:4},{value:"\ud83d\udd34 Fase Final \u2013 Informe operativo",id:"-fase-final--informe-operativo",level:3},{value:"\ud83d\udfea Ejercicio 7 \u2013 Informe de consistencia (<code>informe_inventario.txt</code>)",id:"-ejercicio-7--informe-de-consistencia-informe_inventariotxt",level:4}];function l(e){const i={a:"a",admonition:"admonition",blockquote:"blockquote",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.header,{children:(0,s.jsx)(i.h1,{id:"725-poo--ficheros",children:"7.2.5 POO + Ficheros"})}),"\n",(0,s.jsxs)(i.p,{children:["En proyectos reales no guardamos variables sueltas, guardamos ",(0,s.jsx)(i.strong,{children:"objetos de dominio"})," (",(0,s.jsx)(i.code,{children:"Producto"}),", ",(0,s.jsx)(i.code,{children:"Usuario"}),", ",(0,s.jsx)(i.code,{children:"Pedido"}),", etc.).\nEl reto es persistir esos objetos sin mezclar l\xf3gica de negocio con l\xf3gica de archivos."]}),"\n",(0,s.jsxs)(i.p,{children:["La clave de esta unidad es aprender a conectar ",(0,s.jsx)(i.strong,{children:"POO + persistencia"})," de forma limpia, mantenible y escalable."]}),"\n",(0,s.jsx)(i.hr,{}),"\n",(0,s.jsx)(i.h2,{id:"1\ufe0f\u20e3-por-qu\xe9-combinar-poo-con-persistencia",children:(0,s.jsx)(i.strong,{children:"1\ufe0f\u20e3 Por qu\xe9 combinar POO con persistencia"})}),"\n",(0,s.jsx)(i.p,{children:"Cuando trabajas con clases, los datos viven en memoria mientras el programa est\xe1 abierto.\nSi quieres conservar el estado entre ejecuciones, necesitas escribirlos en disco (JSON, CSV, base de datos...)."}),"\n",(0,s.jsx)(i.p,{children:"Problema t\xedpico:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["En memoria tienes objetos (",(0,s.jsx)(i.code,{children:"Producto(...)"}),")."]}),"\n",(0,s.jsxs)(i.li,{children:["En disco se guardan estructuras serializables (",(0,s.jsx)(i.code,{children:"dict"}),", ",(0,s.jsx)(i.code,{children:"list"}),", ",(0,s.jsx)(i.code,{children:"str"}),", etc.)."]}),"\n"]}),"\n",(0,s.jsx)(i.p,{children:"Por tanto, necesitas una transformaci\xf3n controlada entre ambos mundos."}),"\n",(0,s.jsx)(i.hr,{}),"\n",(0,s.jsx)(i.h2,{id:"2\ufe0f\u20e3-patr\xf3n-de-transformaci\xf3n-to_dict--from_dict",children:(0,s.jsxs)(i.strong,{children:["2\ufe0f\u20e3 Patr\xf3n de transformaci\xf3n (",(0,s.jsx)(i.code,{children:"to_dict"})," / ",(0,s.jsx)(i.code,{children:"from_dict"}),")"]})}),"\n",(0,s.jsxs)(i.p,{children:["La forma m\xe1s com\xfan de persistir objetos en JSON es convertir cada objeto a diccionario al guardar y reconstruirlo al cargar. Esta operaci\xf3n la haremos con los m\xe9todos ",(0,s.jsx)(i.code,{children:"to_dict"})," y ",(0,s.jsx)(i.code,{children:"from_dict"}),", no son m\xe9todos obligatorios de Python ni del m\xf3dulo ",(0,s.jsx)(i.code,{children:"json"}),". Son una ",(0,s.jsx)(i.strong,{children:"convenci\xf3n de dise\xf1o"})," muy extendida en proyectos reales porque hacen expl\xedcita la traducci\xf3n:"]}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["Objeto Python -> estructura serializable (",(0,s.jsx)(i.code,{children:"dict"}),") con ",(0,s.jsx)(i.code,{children:"to_dict()"}),"."]}),"\n",(0,s.jsxs)(i.li,{children:["Estructura serializable (",(0,s.jsx)(i.code,{children:"dict"}),") -> objeto Python con ",(0,s.jsx)(i.code,{children:"from_dict()"}),"."]}),"\n"]}),"\n",(0,s.jsx)(i.p,{children:"Es decir, son un patr\xf3n recomendado, no una regla del lenguaje."}),"\n",(0,s.jsx)(i.admonition,{title:"Importante",type:"tip",children:(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.code,{children:"to_dict"})," / ",(0,s.jsx)(i.code,{children:"from_dict"})," ",(0,s.jsx)(i.strong,{children:"no son m\xe9todos m\xe1gicos"})," (dunder).",(0,s.jsx)(i.br,{}),"\n","Son m\xe9todos normales definidos por dise\xf1o para mantener la persistencia bajo control."]})}),"\n",(0,s.jsx)(i.h3,{id:"-modelo-de-clase-persistente",children:"\ud83d\udfe9 Modelo de clase persistente"}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-python",metastring:'title="Clase preparada para persistencia"',children:'class Producto:\n    def __init__(self, sku, nombre, precio, stock=0):\n        self.sku = sku\n        self.nombre = nombre\n        self.precio = precio\n        self.stock = stock\n\n    def to_dict(self):\n        return {\n            "sku": self.sku,\n            "nombre": self.nombre,\n            "precio": self.precio,\n            "stock": self.stock,\n        }\n\n    @classmethod\n    def from_dict(cls, datos):\n        return cls(\n            sku=datos["sku"],\n            nombre=datos["nombre"],\n            precio=datos["precio"],\n            stock=datos.get("stock", 0),\n        )\n'})}),"\n",(0,s.jsx)(i.admonition,{type:"explicacion",children:(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"to_dict()"})," define el formato de salida del objeto."]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"from_dict()"})," centraliza la reconstrucci\xf3n del objeto."]}),"\n",(0,s.jsxs)(i.li,{children:["Usar ",(0,s.jsx)(i.code,{children:'get("stock", 0)'})," evita fallos con archivos de versiones antiguas."]}),"\n"]})}),"\n",(0,s.jsx)(i.h3,{id:"-comparativa-r\xe1pida",children:"\ud83d\udfe8 Comparativa r\xe1pida"}),"\n",(0,s.jsxs)(i.table,{children:[(0,s.jsx)(i.thead,{children:(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.th,{children:"Enfoque"}),(0,s.jsx)(i.th,{children:"Ventaja"}),(0,s.jsx)(i.th,{children:"Riesgo"})]})}),(0,s.jsxs)(i.tbody,{children:[(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"Guardar atributos sueltos en cualquier parte"}),(0,s.jsx)(i.td,{children:"R\xe1pido al inicio"}),(0,s.jsx)(i.td,{children:"Caos al crecer el proyecto"})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsxs)(i.td,{children:[(0,s.jsx)(i.code,{children:"to_dict"})," / ",(0,s.jsx)(i.code,{children:"from_dict"})," en la clase"]}),(0,s.jsx)(i.td,{children:"Consistencia y mantenibilidad"}),(0,s.jsx)(i.td,{children:"Requiere disciplina de dise\xf1o"})]})]})]}),"\n",(0,s.jsx)(i.hr,{}),"\n",(0,s.jsx)(i.h2,{id:"3\ufe0f\u20e3-separaci\xf3n-de-responsabilidades-clase-repositorio",children:(0,s.jsx)(i.strong,{children:"3\ufe0f\u20e3 Separaci\xf3n de responsabilidades: clase repositorio"})}),"\n",(0,s.jsxs)(i.p,{children:["La clase de dominio (",(0,s.jsx)(i.code,{children:"Producto"}),") no deber\xeda abrir ni cerrar archivos.\nEsa tarea va en una clase de persistencia (repositorio, manager o DAO)."]}),"\n",(0,s.jsx)(i.h3,{id:"-c\xf3mo-se-implementa-un-repositorio-paso-a-paso",children:"\ud83d\udfe9 C\xf3mo se implementa un repositorio (paso a paso)"}),"\n",(0,s.jsx)(i.p,{children:"Un repositorio m\xednimo suele seguir este dise\xf1o:"}),"\n",(0,s.jsxs)(i.ol,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"__init__(ruta)"})," guarda la ubicaci\xf3n del fichero."]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"cargar()"})," lee el fichero y devuelve objetos de dominio."]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"guardar(lista_objetos)"})," serializa y persiste en disco."]}),"\n",(0,s.jsxs)(i.li,{children:["(Opcional) m\xe9todos de conveniencia como ",(0,s.jsx)(i.code,{children:"buscar_por_id"}),", ",(0,s.jsx)(i.code,{children:"actualizar"}),", ",(0,s.jsx)(i.code,{children:"eliminar"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(i.p,{children:["La idea central es que el resto del programa no sepa nada de ",(0,s.jsx)(i.code,{children:"open()"}),", ",(0,s.jsx)(i.code,{children:"json.load()"})," o ",(0,s.jsx)(i.code,{children:"json.dump()"}),".\nSolo trabaja con objetos y llama al repositorio."]}),"\n",(0,s.jsx)(i.h3,{id:"-repositorio-b\xe1sico-de-inventario",children:"\ud83d\udfe6 Repositorio b\xe1sico de inventario"}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-python",metastring:'title="Repositorio JSON"',children:'import json\n\nclass InventarioRepositorio:\n    def __init__(self, ruta):\n        self.ruta = ruta\n\n    def guardar(self, productos):\n        datos = [p.to_dict() for p in productos]\n        with open(self.ruta, "w", encoding="utf-8") as f:\n            json.dump(datos, f, indent=4, ensure_ascii=False)\n\n    def cargar(self):\n        try:\n            with open(self.ruta, "r", encoding="utf-8") as f:\n                datos = json.load(f)\n            return [Producto.from_dict(d) for d in datos]\n        except (FileNotFoundError, json.JSONDecodeError):\n            return []\n'})}),"\n",(0,s.jsx)(i.h3,{id:"-contrato-recomendado-del-repositorio",children:"\ud83d\udfe8 Contrato recomendado del repositorio"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"cargar()"})," siempre devuelve una colecci\xf3n v\xe1lida (normalmente lista, aunque est\xe9 vac\xeda)."]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"guardar(...)"})," recibe entidades de dominio y no diccionarios crudos."]}),"\n",(0,s.jsxs)(i.li,{children:["El repositorio captura errores de infraestructura habituales (",(0,s.jsx)(i.code,{children:"FileNotFoundError"}),", ",(0,s.jsx)(i.code,{children:"JSONDecodeError"}),") y deja la l\xf3gica de negocio limpia."]}),"\n"]}),"\n",(0,s.jsx)(i.p,{children:"Este contrato reduce acoplamiento y facilita pruebas."}),"\n",(0,s.jsx)(i.h3,{id:"-ventaja-arquitect\xf3nica",children:"\ud83d\udfe7 Ventaja arquitect\xf3nica"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["La clase ",(0,s.jsx)(i.code,{children:"Producto"})," se centra en reglas de negocio."]}),"\n",(0,s.jsx)(i.li,{children:"El repositorio se centra en E/S de archivos."}),"\n",(0,s.jsx)(i.li,{children:"Cambiar de JSON a BD impacta menos al resto del sistema."}),"\n"]}),"\n",(0,s.jsx)(i.hr,{}),"\n",(0,s.jsx)(i.h2,{id:"4\ufe0f\u20e3-identificadores-\xfanicos-y-consistencia-de-objetos",children:(0,s.jsx)(i.strong,{children:"4\ufe0f\u20e3 Identificadores \xfanicos y consistencia de objetos"})}),"\n",(0,s.jsx)(i.p,{children:"Si no controlas identificadores, aparecen duplicados y datos inconsistentes."}),"\n",(0,s.jsxs)(i.h3,{id:"-b\xfasqueda-y-actualizaci\xf3n-por-sku",children:["\ud83d\udfe9 B\xfasqueda y actualizaci\xf3n por ",(0,s.jsx)(i.code,{children:"sku"})]}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-python",metastring:'title="Actualizar por identificador \xfanico"',children:"def actualizar_precio(productos, sku_buscado, nuevo_precio):\n    for p in productos:\n        if p.sku == sku_buscado:\n            p.precio = nuevo_precio\n            return True\n    return False\n"})}),"\n",(0,s.jsx)(i.h3,{id:"-control-b\xe1sico-de-alta-duplicada",children:"\ud83d\udfe6 Control b\xe1sico de alta duplicada"}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-python",metastring:'title="Evitar duplicados"',children:"def agregar_producto(productos, nuevo):\n    if any(p.sku == nuevo.sku for p in productos):\n        return False\n    productos.append(nuevo)\n    return True\n"})}),"\n",(0,s.jsx)(i.admonition,{title:"Regla pr\xe1ctica",type:"tip",children:(0,s.jsxs)(i.p,{children:["En persistencia basada en ficheros, define siempre un campo clave (",(0,s.jsx)(i.code,{children:"id"}),", ",(0,s.jsx)(i.code,{children:"sku"}),", ",(0,s.jsx)(i.code,{children:"uuid"}),") antes de implementar altas/ediciones."]})}),"\n",(0,s.jsx)(i.hr,{}),"\n",(0,s.jsx)(i.h2,{id:"5\ufe0f\u20e3-estrategias-de-guardado",children:(0,s.jsx)(i.strong,{children:"5\ufe0f\u20e3 Estrategias de guardado"})}),"\n",(0,s.jsx)(i.p,{children:"No existe una \xfanica estrategia correcta; depende del riesgo de p\xe9rdida y del volumen de cambios."}),"\n",(0,s.jsx)(i.h3,{id:"-guardado-por-evento",children:"\ud83d\udfe9 Guardado por evento"}),"\n",(0,s.jsx)(i.p,{children:"Guardar tras cada cambio relevante."}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"M\xe1s seguro frente a cierres inesperados."}),"\n",(0,s.jsx)(i.li,{children:"Puede penalizar rendimiento si hay muchas operaciones."}),"\n"]}),"\n",(0,s.jsx)(i.h3,{id:"-guardado-al-final",children:"\ud83d\udfe6 Guardado al final"}),"\n",(0,s.jsx)(i.p,{children:"Guardar una sola vez al terminar."}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"R\xe1pido durante la ejecuci\xf3n."}),"\n",(0,s.jsx)(i.li,{children:"Mayor riesgo de perder cambios si hay fallo."}),"\n"]}),"\n",(0,s.jsx)(i.h3,{id:"-auto-guardado-por-lote",children:"\ud83d\udfe8 Auto-guardado por lote"}),"\n",(0,s.jsx)(i.p,{children:"Guardar cada X operaciones o cada X segundos."}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Equilibrio entre seguridad y rendimiento."}),"\n",(0,s.jsx)(i.li,{children:"Muy \xfatil en aplicaciones de escritorio o CLI largas."}),"\n"]}),"\n",(0,s.jsx)(i.h3,{id:"-comparativa-de-estrategia",children:"\ud83d\udfe7 Comparativa de estrategia"}),"\n",(0,s.jsxs)(i.table,{children:[(0,s.jsx)(i.thead,{children:(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.th,{children:"Estrategia"}),(0,s.jsx)(i.th,{children:"Seguridad de datos"}),(0,s.jsx)(i.th,{children:"Rendimiento"}),(0,s.jsx)(i.th,{children:"Uso t\xedpico"})]})}),(0,s.jsxs)(i.tbody,{children:[(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"Por evento"}),(0,s.jsx)(i.td,{children:"Alta"}),(0,s.jsx)(i.td,{children:"Medio/Bajo"}),(0,s.jsx)(i.td,{children:"Sistemas cr\xedticos"})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"Al final"}),(0,s.jsx)(i.td,{children:"Baja"}),(0,s.jsx)(i.td,{children:"Alta"}),(0,s.jsx)(i.td,{children:"Scripts peque\xf1os"})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"Por lote"}),(0,s.jsx)(i.td,{children:"Media/Alta"}),(0,s.jsx)(i.td,{children:"Media/Alta"}),(0,s.jsx)(i.td,{children:"Apps interactivas"})]})]})]}),"\n",(0,s.jsx)(i.hr,{}),"\n",(0,s.jsx)(i.h2,{id:"6\ufe0f\u20e3-evoluci\xf3n-de-esquema-y-compatibilidad",children:(0,s.jsx)(i.strong,{children:"6\ufe0f\u20e3 Evoluci\xf3n de esquema y compatibilidad"})}),"\n",(0,s.jsxs)(i.p,{children:["Con el tiempo, tus clases cambian (",(0,s.jsx)(i.code,{children:"stock"}),", ",(0,s.jsx)(i.code,{children:"categoria"}),", ",(0,s.jsx)(i.code,{children:"activo"}),", etc.).\nSi no preparas compatibilidad, los archivos antiguos dejar\xe1n de cargar."]}),"\n",(0,s.jsx)(i.h3,{id:"-compatibilidad-hacia-atr\xe1s-con-valores-por-defecto",children:"\ud83d\udfe9 Compatibilidad hacia atr\xe1s con valores por defecto"}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-python",metastring:'title="from_dict defensivo"',children:'@classmethod\ndef from_dict(cls, datos):\n    return cls(\n        sku=datos["sku"],\n        nombre=datos["nombre"],\n        precio=datos["precio"],\n        stock=datos.get("stock", 0),\n    )\n'})}),"\n",(0,s.jsx)(i.h3,{id:"-migraciones-simples-por-versi\xf3n",children:"\ud83d\udfe6 Migraciones simples por versi\xf3n"}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-python",metastring:'title="Migraci\xf3n m\xednima de datos"',children:'def migrar_producto(datos):\n    version = datos.get("_version", 1)\n\n    if version == 1:\n        datos["stock"] = 0\n        datos["_version"] = 2\n\n    return datos\n'})}),"\n",(0,s.jsx)(i.admonition,{title:"Recomendaci\xf3n",type:"info",children:(0,s.jsxs)(i.p,{children:["Si tu modelo va a evolucionar, a\xf1ade desde el principio un campo ",(0,s.jsx)(i.code,{children:"_version"})," en el formato persistido."]})}),"\n",(0,s.jsx)(i.hr,{}),"\n",(0,s.jsx)(i.h2,{id:"7\ufe0f\u20e3-ejemplo-completo-servicio--repositorio",children:(0,s.jsx)(i.strong,{children:"7\ufe0f\u20e3 Ejemplo completo: servicio + repositorio"})}),"\n",(0,s.jsxs)(i.p,{children:["Este ejemplo muestra el ciclo m\xednimo real: ",(0,s.jsx)(i.strong,{children:"cargar estado"}),", ",(0,s.jsx)(i.strong,{children:"operar con objetos"})," y ",(0,s.jsx)(i.strong,{children:"persistir cambios"}),"."]}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-python",metastring:'title="Flujo completo de inventario"',children:'repo = InventarioRepositorio("inventario.json")\nproductos = repo.cargar()\n\nok = agregar_producto(productos, Producto("SKU-900", "Webcam Pro", 69.9, 12))\nif ok:\n    repo.guardar(productos)\n'})}),"\n",(0,s.jsxs)(i.blockquote,{children:["\n",(0,s.jsxs)(i.p,{children:["Flujo recomendado: ",(0,s.jsx)(i.strong,{children:"cargar -> operar en objetos -> validar -> guardar"}),"."]}),"\n"]}),"\n",(0,s.jsx)(i.hr,{}),"\n",(0,s.jsx)(i.h2,{id:"-buenas-pr\xe1cticas-recomendadas",children:(0,s.jsx)(i.strong,{children:"\u2705 Buenas pr\xe1cticas recomendadas"})}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["Mant\xe9n ",(0,s.jsx)(i.code,{children:"to_dict"})," / ",(0,s.jsx)(i.code,{children:"from_dict"})," en cada entidad persistible."]}),"\n",(0,s.jsx)(i.li,{children:"No mezcles E/S dentro de tus clases de dominio."}),"\n",(0,s.jsx)(i.li,{children:"Define identificadores \xfanicos y valida duplicados."}),"\n",(0,s.jsxs)(i.li,{children:["Gestiona compatibilidad de esquema con ",(0,s.jsx)(i.code,{children:".get()"})," y versiones."]}),"\n",(0,s.jsxs)(i.li,{children:["Usa escritura segura (",(0,s.jsx)(i.code,{children:"tmp"})," + reemplazo) cuando los datos sean cr\xedticos."]}),"\n"]}),"\n",(0,s.jsx)(i.hr,{}),"\n",(0,s.jsxs)(i.h2,{id:"-ejercicios-pr\xe1cticos--proyecto-atlas",children:[(0,s.jsx)(i.strong,{children:"\ud83e\uddea Ejercicios pr\xe1cticos"})," \u2013 Proyecto Atlas"]}),"\n",(0,s.jsx)(i.p,{children:"El equipo de operaciones necesita migrar su inventario a una arquitectura orientada a objetos con persistencia en JSON.\nTu misi\xf3n es reconstruir el m\xf3dulo de inventario usando clases, repositorio y validaciones de consistencia."}),"\n",(0,s.jsxs)(i.p,{children:["Dispones de estos ficheros: \ud83d\udc49 ",(0,s.jsx)(i.strong,{children:(0,s.jsx)(i.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:o(3394).A+"",children:"Desc\xe1rgalos aqu\xed"})})]}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"inventario_base.json"})," -> estado inicial del cat\xe1logo"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"movimientos_stock.json"})," -> entradas/salidas de unidades"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"inventario_legacy.json"})," -> datos de versi\xf3n antigua sin ",(0,s.jsx)(i.code,{children:"stock"})]}),"\n"]}),"\n",(0,s.jsx)(i.h3,{id:"-fase-1--modelo-y-carga-inicial",children:"\ud83d\udfe2 Fase 1 \u2013 Modelo y carga inicial"}),"\n",(0,s.jsxs)(i.h4,{id:"-ejercicio-1--clase-producto-persistible",children:["\ud83d\udfe9 Ejercicio 1 \u2013 Clase ",(0,s.jsx)(i.code,{children:"Producto"})," persistible"]}),"\n",(0,s.jsxs)(i.p,{children:["Crea la clase ",(0,s.jsx)(i.code,{children:"Producto"})," con:"]}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["Atributos: ",(0,s.jsx)(i.code,{children:"sku"}),", ",(0,s.jsx)(i.code,{children:"nombre"}),", ",(0,s.jsx)(i.code,{children:"precio"}),", ",(0,s.jsx)(i.code,{children:"stock"})]}),"\n",(0,s.jsxs)(i.li,{children:["M\xe9todo ",(0,s.jsx)(i.code,{children:"to_dict()"})]}),"\n",(0,s.jsxs)(i.li,{children:["M\xe9todo de clase ",(0,s.jsx)(i.code,{children:"from_dict()"})]}),"\n"]}),"\n",(0,s.jsx)(i.p,{children:"Objetivo: definir el contrato de transformaci\xf3n objeto <-> diccionario."}),"\n",(0,s.jsx)(i.h4,{id:"-ejercicio-2--repositorio-de-inventario",children:"\ud83d\udfe6 Ejercicio 2 \u2013 Repositorio de inventario"}),"\n",(0,s.jsxs)(i.p,{children:["Implementa ",(0,s.jsx)(i.code,{children:"InventarioRepositorio"})," con:"]}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:(0,s.jsx)(i.code,{children:"cargar()"})}),"\n",(0,s.jsx)(i.li,{children:(0,s.jsx)(i.code,{children:"guardar(lista_productos)"})}),"\n"]}),"\n",(0,s.jsxs)(i.p,{children:["Usa ",(0,s.jsx)(i.code,{children:"inventario_base.json"})," como fuente inicial."]}),"\n",(0,s.jsx)(i.p,{children:"Objetivo: separar dominio y persistencia."}),"\n",(0,s.jsx)(i.h3,{id:"-fase-2--operaciones-de-negocio",children:"\ud83d\udfe1 Fase 2 \u2013 Operaciones de negocio"}),"\n",(0,s.jsx)(i.h4,{id:"-ejercicio-3--alta-segura-de-productos",children:"\ud83d\udfe8 Ejercicio 3 \u2013 Alta segura de productos"}),"\n",(0,s.jsxs)(i.p,{children:["Implementa una funci\xf3n para a\xf1adir productos sin duplicar ",(0,s.jsx)(i.code,{children:"sku"}),"."]}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["Si el ",(0,s.jsx)(i.code,{children:"sku"})," existe, no se a\xf1ade."]}),"\n",(0,s.jsx)(i.li,{children:"Si no existe, se a\xf1ade y devuelve \xe9xito."}),"\n"]}),"\n",(0,s.jsx)(i.p,{children:"Objetivo: proteger integridad del inventario."}),"\n",(0,s.jsx)(i.h4,{id:"-ejercicio-4--aplicar-movimientos-de-stock",children:"\ud83d\udfe7 Ejercicio 4 \u2013 Aplicar movimientos de stock"}),"\n",(0,s.jsxs)(i.p,{children:["Lee ",(0,s.jsx)(i.code,{children:"movimientos_stock.json"})," y aplica cada operaci\xf3n:"]}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"ENTRADA"})," -> suma unidades"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"SALIDA"})," -> resta unidades (sin dejar stock negativo)"]}),"\n"]}),"\n",(0,s.jsxs)(i.p,{children:["Genera ",(0,s.jsx)(i.code,{children:"inventario_actualizado.json"}),"."]}),"\n",(0,s.jsx)(i.p,{children:"Objetivo: trabajar con objetos en memoria y persistencia final."}),"\n",(0,s.jsx)(i.h3,{id:"-fase-3--evoluci\xf3n-de-esquema",children:"\ud83d\udd35 Fase 3 \u2013 Evoluci\xf3n de esquema"}),"\n",(0,s.jsx)(i.h4,{id:"-ejercicio-5--cargar-datos-legacy",children:"\ud83d\udfe5 Ejercicio 5 \u2013 Cargar datos legacy"}),"\n",(0,s.jsxs)(i.p,{children:["Usa ",(0,s.jsx)(i.code,{children:"inventario_legacy.json"}),", donde no existe ",(0,s.jsx)(i.code,{children:"stock"}),", y c\xe1rgalo sin errores."]}),"\n",(0,s.jsx)(i.p,{children:"Condici\xf3n:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"from_dict()"})," debe asignar ",(0,s.jsx)(i.code,{children:"stock = 0"})," por defecto."]}),"\n"]}),"\n",(0,s.jsx)(i.p,{children:"Objetivo: mantener compatibilidad hacia atr\xe1s."}),"\n",(0,s.jsx)(i.h4,{id:"-ejercicio-6--migraci\xf3n-con-versi\xf3n",children:"\ud83d\udfeb Ejercicio 6 \u2013 Migraci\xf3n con versi\xf3n"}),"\n",(0,s.jsxs)(i.p,{children:["Crea un script que lea ",(0,s.jsx)(i.code,{children:"inventario_legacy.json"})," y genere ",(0,s.jsx)(i.code,{children:"inventario_v2.json"})," con:"]}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["Campo ",(0,s.jsx)(i.code,{children:"stock"})]}),"\n",(0,s.jsxs)(i.li,{children:["Campo ",(0,s.jsx)(i.code,{children:"_version"})," con valor ",(0,s.jsx)(i.code,{children:"2"})]}),"\n"]}),"\n",(0,s.jsx)(i.p,{children:"Objetivo: practicar migraci\xf3n expl\xedcita de datos."}),"\n",(0,s.jsx)(i.h3,{id:"-fase-final--informe-operativo",children:"\ud83d\udd34 Fase Final \u2013 Informe operativo"}),"\n",(0,s.jsxs)(i.h4,{id:"-ejercicio-7--informe-de-consistencia-informe_inventariotxt",children:["\ud83d\udfea Ejercicio 7 \u2013 Informe de consistencia (",(0,s.jsx)(i.code,{children:"informe_inventario.txt"}),")"]}),"\n",(0,s.jsx)(i.p,{children:"Genera un informe con:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Total de productos."}),"\n",(0,s.jsx)(i.li,{children:"Total de SKUs duplicados detectados."}),"\n",(0,s.jsxs)(i.li,{children:["Valor total del inventario (",(0,s.jsx)(i.code,{children:"precio * stock"}),")."]}),"\n",(0,s.jsx)(i.li,{children:"Productos con stock cr\xedtico (menor que 3)."}),"\n"]}),"\n",(0,s.jsx)(i.p,{children:"Formato sugerido:"}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-txt",children:"Productos totales: X\nSKUs duplicados: X\nValor inventario: XXXX.XX\nStock cr\xedtico: SKU-001, SKU-010\n"})})]})}function h(e={}){const{wrapper:i}={...(0,r.R)(),...e.components};return i?(0,s.jsx)(i,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},3394:(e,i,o)=>{o.d(i,{A:()=>n});const n=o.p+"assets/files/7_2_5_ficheros-749eab7737d9a5a7aa218d6b87e21b15.zip"},8453:(e,i,o)=>{o.d(i,{R:()=>c,x:()=>a});var n=o(6540);const s={},r=n.createContext(s);function c(e){const i=n.useContext(r);return n.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function a(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:c(e.components),n.createElement(r.Provider,{value:i},e.children)}}}]);