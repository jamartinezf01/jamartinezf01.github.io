"use strict";(self.webpackChunkp_my_dm=self.webpackChunkp_my_dm||[]).push([[9240],{1966:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>d,contentTitle:()=>c,default:()=>p,frontMatter:()=>o,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"python/UT7 - Persistencia/7.2 Ficheros/7.2.6_manejo_errores","title":"7.2.6 Manejo de Errores","description":"Cuando trabajamos con ficheros, el error no es una excepci\xf3n rara: es parte del flujo normal.","source":"@site/docs/python/UT7 - Persistencia/7.2 Ficheros/7.2.6_manejo_errores.md","sourceDirName":"python/UT7 - Persistencia/7.2 Ficheros","slug":"/python/UT7 - Persistencia/7.2 Ficheros/7.2.6_manejo_errores","permalink":"/docs/python/UT7 - Persistencia/7.2 Ficheros/7.2.6_manejo_errores","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":7,"frontMatter":{"sidebar_position":7},"sidebar":"pythonSidebar","previous":{"title":"7.2.5 POO + Ficheros","permalink":"/docs/python/UT7 - Persistencia/7.2 Ficheros/7.2.5_poo_ficheros"},"next":{"title":"7.2.7 Sistema de Archivos","permalink":"/docs/python/UT7 - Persistencia/7.2 Ficheros/7.2.7_sistema_archivos"}}');var s=n(4848),a=n(8453);const o={sidebar_position:7},c="7.2.6 Manejo de Errores",d={},l=[{value:"<strong>1\ufe0f\u20e3 Enfoque Python: EAFP vs LBYL</strong>",id:"1\ufe0f\u20e3-enfoque-python-eafp-vs-lbyl",level:2},{value:"\ud83d\udfe9 Ejemplo de LBYL",id:"-ejemplo-de-lbyl",level:3},{value:"\ud83d\udfe6 Ejemplo de EAFP (recomendado)",id:"-ejemplo-de-eafp-recomendado",level:3},{value:"\ud83d\udfe8 Comparativa (<code>LBYL</code> vs <code>EAFP</code>)",id:"-comparativa-lbyl-vs-eafp",level:3},{value:"<strong>2\ufe0f\u20e3 Excepciones comunes de E/S</strong>",id:"2\ufe0f\u20e3-excepciones-comunes-de-es",level:2},{value:"\ud83d\udfe9 Captura espec\xedfica de errores",id:"-captura-espec\xedfica-de-errores",level:3},{value:"\ud83d\udfe6 Cu\xe1ndo usar <code>except Exception</code>",id:"-cu\xe1ndo-usar-except-exception",level:3},{value:"\ud83d\udfe8 Comparativa de captura",id:"-comparativa-de-captura",level:3},{value:"<strong>3\ufe0f\u20e3 Logging: registrar, no improvisar</strong>",id:"3\ufe0f\u20e3-logging-registrar-no-improvisar",level:2},{value:"\ud83d\udfe9 Configuraci\xf3n base de <code>logging</code>",id:"-configuraci\xf3n-base-de-logging",level:3},{value:"\ud83d\udfe6 Registrar errores con contexto",id:"-registrar-errores-con-contexto",level:3},{value:"\ud83d\udfe8 Niveles t\xedpicos",id:"-niveles-t\xedpicos",level:3},{value:"<strong>4\ufe0f\u20e3 Escritura segura y recuperaci\xf3n ante fallos</strong>",id:"4\ufe0f\u20e3-escritura-segura-y-recuperaci\xf3n-ante-fallos",level:2},{value:"\ud83d\udfe9 Patr\xf3n seguro (<code>tmp</code> + reemplazo)",id:"-patr\xf3n-seguro-tmp--reemplazo",level:3},{value:"\ud83d\udfe6 Backup antes de sobrescribir",id:"-backup-antes-de-sobrescribir",level:3},{value:"\ud83d\udfe8 Comparativa r\xe1pida",id:"-comparativa-r\xe1pida",level:3},{value:"<strong>5\ufe0f\u20e3 Limpieza garantizada con <code>finally</code></strong>",id:"5\ufe0f\u20e3-limpieza-garantizada-con-finally",level:2},{value:"\ud83d\udfe9 Ejemplo con limpieza obligatoria",id:"-ejemplo-con-limpieza-obligatoria",level:3},{value:"\ud83d\udfe6 Cu\xe1ndo usar <code>finally</code>",id:"-cu\xe1ndo-usar-finally",level:3},{value:"\ud83d\udfe8 Diferencia clave",id:"-diferencia-clave",level:3},{value:"<strong>6\ufe0f\u20e3 Dise\xf1o de errores en capas (recomendado)</strong>",id:"6\ufe0f\u20e3-dise\xf1o-de-errores-en-capas-recomendado",level:2},{value:"\ud83d\udfe9 Capa de infraestructura",id:"-capa-de-infraestructura",level:3},{value:"\ud83d\udfe6 Capa de negocio",id:"-capa-de-negocio",level:3},{value:"\ud83d\udfe8 Patr\xf3n simple",id:"-patr\xf3n-simple",level:3},{value:"<strong>7\ufe0f\u20e3 Ejemplo completo: lectura robusta + guardado seguro</strong>",id:"7\ufe0f\u20e3-ejemplo-completo-lectura-robusta--guardado-seguro",level:2},{value:"<strong>\u2705 Buenas pr\xe1cticas recomendadas</strong>",id:"-buenas-pr\xe1cticas-recomendadas",level:2},{value:"<strong>\ud83e\uddea Ejercicios pr\xe1cticos</strong> \u2013 Escudo Sentinel",id:"-ejercicios-pr\xe1cticos--escudo-sentinel",level:2},{value:"\ud83d\udfe2 Fase 1 \u2013 Diagn\xf3stico de errores",id:"-fase-1--diagn\xf3stico-de-errores",level:3},{value:"\ud83d\udfe9 Ejercicio 1 \u2013 Carga defensiva de configuraci\xf3n",id:"-ejercicio-1--carga-defensiva-de-configuraci\xf3n",level:4},{value:"\ud83d\udfe6 Ejercicio 2 \u2013 Registro de incidencias con <code>logging</code>",id:"-ejercicio-2--registro-de-incidencias-con-logging",level:4},{value:"\ud83d\udfe1 Fase 2 \u2013 Recuperaci\xf3n segura",id:"-fase-2--recuperaci\xf3n-segura",level:3},{value:"\ud83d\udfe8 Ejercicio 3 \u2013 Guardado at\xf3mico de resumen",id:"-ejercicio-3--guardado-at\xf3mico-de-resumen",level:4},{value:"\ud83d\udfe7 Ejercicio 4 \u2013 Backup previo del inventario",id:"-ejercicio-4--backup-previo-del-inventario",level:4},{value:"\ud83d\udd35 Fase 3 \u2013 Limpieza y robustez",id:"-fase-3--limpieza-y-robustez",level:3},{value:"\ud83d\udfe5 Ejercicio 5 \u2013 Limpieza con <code>finally</code>",id:"-ejercicio-5--limpieza-con-finally",level:4},{value:"\ud83d\udfeb Ejercicio 6 \u2013 Traducci\xf3n de errores a dominio",id:"-ejercicio-6--traducci\xf3n-de-errores-a-dominio",level:4},{value:"\ud83d\udd34 Fase Final \u2013 Informe de resiliencia",id:"-fase-final--informe-de-resiliencia",level:3},{value:"\ud83d\udfea Ejercicio 7 \u2013 Informe final (<code>informe_resiliencia.txt</code>)",id:"-ejercicio-7--informe-final-informe_resilienciatxt",level:4}];function t(e){const r={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.header,{children:(0,s.jsx)(r.h1,{id:"726-manejo-de-errores",children:"7.2.6 Manejo de Errores"})}),"\n",(0,s.jsx)(r.p,{children:"Cuando trabajamos con ficheros, el error no es una excepci\xf3n rara: es parte del flujo normal.\nUn archivo puede no existir, tener formato inv\xe1lido, estar bloqueado o tener permisos insuficientes."}),"\n",(0,s.jsxs)(r.p,{children:['Por eso, manejar errores no es "poner un ',(0,s.jsx)(r.code,{children:"try"}),'"; es dise\xf1ar c\xf3mo reacciona el sistema sin perder datos ni romper la ejecuci\xf3n.']}),"\n",(0,s.jsx)(r.hr,{}),"\n",(0,s.jsx)(r.h2,{id:"1\ufe0f\u20e3-enfoque-python-eafp-vs-lbyl",children:(0,s.jsx)(r.strong,{children:"1\ufe0f\u20e3 Enfoque Python: EAFP vs LBYL"})}),"\n",(0,s.jsx)(r.p,{children:"En Python existen dos estilos para prevenir fallos:"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"LBYL"})," (",(0,s.jsx)(r.em,{children:"Look Before You Leap"}),"): comprobar antes de actuar."]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"EAFP"})," (",(0,s.jsx)(r.em,{children:"Easier to Ask Forgiveness than Permission"}),"): actuar y capturar excepciones si algo falla."]}),"\n"]}),"\n",(0,s.jsx)(r.h3,{id:"-ejemplo-de-lbyl",children:"\ud83d\udfe9 Ejemplo de LBYL"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-python",children:'import os\n\nif os.path.exists("datos.txt"):\n    with open("datos.txt", "r", encoding="utf-8") as f:\n        contenido = f.read()\n'})}),"\n",(0,s.jsx)(r.h3,{id:"-ejemplo-de-eafp-recomendado",children:"\ud83d\udfe6 Ejemplo de EAFP (recomendado)"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-python",children:'try:\n    with open("datos.txt", "r", encoding="utf-8") as f:\n        contenido = f.read()\nexcept FileNotFoundError:\n    contenido = ""\n'})}),"\n",(0,s.jsxs)(r.h3,{id:"-comparativa-lbyl-vs-eafp",children:["\ud83d\udfe8 Comparativa (",(0,s.jsx)(r.code,{children:"LBYL"})," vs ",(0,s.jsx)(r.code,{children:"EAFP"}),")"]}),"\n",(0,s.jsxs)(r.table,{children:[(0,s.jsx)(r.thead,{children:(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.th,{children:"Criterio"}),(0,s.jsx)(r.th,{children:"LBYL"}),(0,s.jsx)(r.th,{children:"EAFP"})]})}),(0,s.jsxs)(r.tbody,{children:[(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"Estilo en Python"}),(0,s.jsx)(r.td,{children:"Menos habitual"}),(0,s.jsx)(r.td,{children:"M\xe1s habitual"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"Riesgo por carrera (TOCTOU)"}),(0,s.jsx)(r.td,{children:"M\xe1s alto"}),(0,s.jsx)(r.td,{children:"M\xe1s bajo"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"Claridad de errores reales"}),(0,s.jsx)(r.td,{children:"Media"}),(0,s.jsx)(r.td,{children:"Alta"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"Recomendado para ficheros"}),(0,s.jsx)(r.td,{children:"No como base principal"}),(0,s.jsx)(r.td,{children:"S\xed"})]})]})]}),"\n",(0,s.jsx)(r.admonition,{title:"Regla pr\xe1ctica",type:"tip",children:(0,s.jsx)(r.p,{children:"En Python, usa EAFP como estrategia principal y captura excepciones concretas."})}),"\n",(0,s.jsx)(r.hr,{}),"\n",(0,s.jsx)(r.h2,{id:"2\ufe0f\u20e3-excepciones-comunes-de-es",children:(0,s.jsx)(r.strong,{children:"2\ufe0f\u20e3 Excepciones comunes de E/S"})}),"\n",(0,s.jsxs)(r.p,{children:["No todos los fallos de ficheros son iguales. Tratar todo con ",(0,s.jsx)(r.code,{children:"except Exception"})," dificulta diagn\xf3stico y mantenimiento."]}),"\n",(0,s.jsx)(r.h3,{id:"-captura-espec\xedfica-de-errores",children:"\ud83d\udfe9 Captura espec\xedfica de errores"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-python",metastring:'title="Captura granular"',children:'try:\n    with open("datos_criticos.dat", "r", encoding="utf-8") as f:\n        datos = f.read()\nexcept FileNotFoundError:\n    print("No existe el archivo.")\nexcept PermissionError:\n    print("No hay permisos suficientes.")\nexcept IsADirectoryError:\n    print("La ruta es una carpeta, no un fichero.")\nexcept UnicodeDecodeError:\n    print("Problema de codificaci\xf3n al leer el archivo.")\nexcept OSError as e:\n    print(f"Error de sistema: {e}")\n'})}),"\n",(0,s.jsxs)(r.h3,{id:"-cu\xe1ndo-usar-except-exception",children:["\ud83d\udfe6 Cu\xe1ndo usar ",(0,s.jsx)(r.code,{children:"except Exception"})]}),"\n",(0,s.jsx)(r.p,{children:"Solo en capas superiores (por ejemplo, punto de entrada de app) para evitar ca\xedda total y registrar fallo inesperado."}),"\n",(0,s.jsx)(r.h3,{id:"-comparativa-de-captura",children:"\ud83d\udfe8 Comparativa de captura"}),"\n",(0,s.jsxs)(r.table,{children:[(0,s.jsx)(r.thead,{children:(0,s.jsxs)(r.tr,{children:[(0,s.jsxs)(r.th,{children:["Tipo de ",(0,s.jsx)(r.code,{children:"except"})]}),(0,s.jsx)(r.th,{children:"Ventaja"}),(0,s.jsx)(r.th,{children:"Riesgo"})]})}),(0,s.jsxs)(r.tbody,{children:[(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"Excepciones espec\xedficas"}),(0,s.jsx)(r.td,{children:"Diagn\xf3stico claro"}),(0,s.jsx)(r.td,{children:"M\xe1s l\xedneas de c\xf3digo"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsxs)(r.td,{children:[(0,s.jsx)(r.code,{children:"except Exception"})," global"]}),(0,s.jsx)(r.td,{children:"Contiene fallos inesperados"}),(0,s.jsx)(r.td,{children:"Oculta errores de l\xf3gica si se abusa"})]})]})]}),"\n",(0,s.jsx)(r.hr,{}),"\n",(0,s.jsx)(r.h2,{id:"3\ufe0f\u20e3-logging-registrar-no-improvisar",children:(0,s.jsx)(r.strong,{children:"3\ufe0f\u20e3 Logging: registrar, no improvisar"})}),"\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.code,{children:"print()"})," sirve en aprendizaje, pero en entornos reales necesitas trazabilidad persistente."]}),"\n",(0,s.jsxs)(r.h3,{id:"-configuraci\xf3n-base-de-logging",children:["\ud83d\udfe9 Configuraci\xf3n base de ",(0,s.jsx)(r.code,{children:"logging"})]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-python",metastring:'title="Logging a fichero"',children:'import logging\n\nlogging.basicConfig(\n    filename="app_errors.log",\n    level=logging.ERROR,\n    format="%(asctime)s | %(levelname)s | %(message)s",\n)\n'})}),"\n",(0,s.jsx)(r.h3,{id:"-registrar-errores-con-contexto",children:"\ud83d\udfe6 Registrar errores con contexto"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-python",children:'try:\n    with open("config.json", "r", encoding="utf-8") as f:\n        config = f.read()\nexcept Exception as e:\n    logging.exception("Fallo al cargar configuraci\xf3n")\n'})}),"\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.code,{children:"logging.exception(...)"})," incluye traza completa, muy \xfatil para depurar."]}),"\n",(0,s.jsx)(r.h3,{id:"-niveles-t\xedpicos",children:"\ud83d\udfe8 Niveles t\xedpicos"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"DEBUG"}),": detalle t\xe9cnico interno."]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"INFO"}),": eventos normales."]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"WARNING"}),": situaci\xf3n an\xf3mala recuperable."]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"ERROR"}),": fallo funcional."]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"CRITICAL"}),": fallo grave del sistema."]}),"\n"]}),"\n",(0,s.jsx)(r.hr,{}),"\n",(0,s.jsx)(r.h2,{id:"4\ufe0f\u20e3-escritura-segura-y-recuperaci\xf3n-ante-fallos",children:(0,s.jsx)(r.strong,{children:"4\ufe0f\u20e3 Escritura segura y recuperaci\xf3n ante fallos"})}),"\n",(0,s.jsxs)(r.p,{children:["Escribir directamente con modo ",(0,s.jsx)(r.code,{children:"w"})," puede dejar un archivo corrupto si la app se interrumpe a mitad."]}),"\n",(0,s.jsxs)(r.h3,{id:"-patr\xf3n-seguro-tmp--reemplazo",children:["\ud83d\udfe9 Patr\xf3n seguro (",(0,s.jsx)(r.code,{children:"tmp"})," + reemplazo)"]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-python",metastring:'title="Escritura at\xf3mica b\xe1sica"',children:'import os\n\nruta_final = "datos.json"\nruta_tmp = "datos.tmp"\n\nwith open(ruta_tmp, "w", encoding="utf-8") as f:\n    f.write(\'{"estado": "ok"}\')\n\nos.replace(ruta_tmp, ruta_final)\n'})}),"\n",(0,s.jsx)(r.h3,{id:"-backup-antes-de-sobrescribir",children:"\ud83d\udfe6 Backup antes de sobrescribir"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-python",metastring:'title="Copia de seguridad m\xednima"',children:'import shutil\n\nshutil.copy2("datos.json", "datos.backup.json")\n'})}),"\n",(0,s.jsx)(r.h3,{id:"-comparativa-r\xe1pida",children:"\ud83d\udfe8 Comparativa r\xe1pida"}),"\n",(0,s.jsxs)(r.table,{children:[(0,s.jsx)(r.thead,{children:(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.th,{children:"T\xe9cnica"}),(0,s.jsx)(r.th,{children:"Qu\xe9 protege"}),(0,s.jsx)(r.th,{children:"Coste"})]})}),(0,s.jsxs)(r.tbody,{children:[(0,s.jsxs)(r.tr,{children:[(0,s.jsxs)(r.td,{children:[(0,s.jsx)(r.code,{children:"tmp"})," + ",(0,s.jsx)(r.code,{children:"replace"})]}),(0,s.jsx)(r.td,{children:"Corrupci\xf3n parcial por interrupci\xf3n"}),(0,s.jsx)(r.td,{children:"Bajo"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"Backup previo"}),(0,s.jsx)(r.td,{children:"Errores l\xf3gicos o humanos"}),(0,s.jsx)(r.td,{children:"Medio (espacio y gesti\xf3n)"})]})]})]}),"\n",(0,s.jsx)(r.hr,{}),"\n",(0,s.jsx)(r.h2,{id:"5\ufe0f\u20e3-limpieza-garantizada-con-finally",children:(0,s.jsxs)(r.strong,{children:["5\ufe0f\u20e3 Limpieza garantizada con ",(0,s.jsx)(r.code,{children:"finally"})]})}),"\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.code,{children:"with"})," cierra archivos autom\xe1ticamente, pero a veces debes limpiar recursos extra (temporales, locks, sockets)."]}),"\n",(0,s.jsx)(r.h3,{id:"-ejemplo-con-limpieza-obligatoria",children:"\ud83d\udfe9 Ejemplo con limpieza obligatoria"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-python",metastring:'title="finally para liberar recursos"',children:'import os\n\nruta_tmp = "proceso.tmp"\n\ntry:\n    with open(ruta_tmp, "w", encoding="utf-8") as f:\n        f.write("estado temporal")\n    # Aqu\xed podr\xeda fallar cualquier paso posterior\n    raise RuntimeError("fallo simulado")\nexcept RuntimeError as e:\n    print(f"Error controlado: {e}")\nfinally:\n    if os.path.exists(ruta_tmp):\n        os.remove(ruta_tmp)\n'})}),"\n",(0,s.jsxs)(r.h3,{id:"-cu\xe1ndo-usar-finally",children:["\ud83d\udfe6 Cu\xe1ndo usar ",(0,s.jsx)(r.code,{children:"finally"})]}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:"Limpieza de archivos temporales."}),"\n",(0,s.jsx)(r.li,{children:"Liberaci\xf3n de bloqueos."}),"\n",(0,s.jsx)(r.li,{children:"Restauraci\xf3n de estado parcial."}),"\n"]}),"\n",(0,s.jsx)(r.h3,{id:"-diferencia-clave",children:"\ud83d\udfe8 Diferencia clave"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"with"}),": garantiza cierre del recurso gestionado por contexto."]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"finally"}),": garantiza ejecutar una acci\xf3n final, ocurra lo que ocurra."]}),"\n"]}),"\n",(0,s.jsx)(r.hr,{}),"\n",(0,s.jsx)(r.h2,{id:"6\ufe0f\u20e3-dise\xf1o-de-errores-en-capas-recomendado",children:(0,s.jsx)(r.strong,{children:"6\ufe0f\u20e3 Dise\xf1o de errores en capas (recomendado)"})}),"\n",(0,s.jsx)(r.p,{children:"Un sistema mantenible separa responsabilidades tambi\xe9n en el manejo de errores."}),"\n",(0,s.jsx)(r.h3,{id:"-capa-de-infraestructura",children:"\ud83d\udfe9 Capa de infraestructura"}),"\n",(0,s.jsxs)(r.p,{children:["Captura excepciones t\xe9cnicas (",(0,s.jsx)(r.code,{children:"FileNotFoundError"}),", ",(0,s.jsx)(r.code,{children:"JSONDecodeError"}),", etc.) y las traduce."]}),"\n",(0,s.jsx)(r.h3,{id:"-capa-de-negocio",children:"\ud83d\udfe6 Capa de negocio"}),"\n",(0,s.jsx)(r.p,{children:"Decide qu\xe9 hacer (continuar, reintentar, abortar, avisar usuario)."}),"\n",(0,s.jsx)(r.h3,{id:"-patr\xf3n-simple",children:"\ud83d\udfe8 Patr\xf3n simple"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-python",metastring:'title="Traducir error t\xe9cnico a error de dominio"',children:'class ConfigError(Exception):\n    pass\n\ndef cargar_config(ruta):\n    import json\n    try:\n        with open(ruta, "r", encoding="utf-8") as f:\n            return json.load(f)\n    except (FileNotFoundError, json.JSONDecodeError) as e:\n        raise ConfigError("No se pudo cargar configuraci\xf3n") from e\n'})}),"\n",(0,s.jsx)(r.p,{children:"Este enfoque evita acoplar toda la aplicaci\xf3n a detalles de infraestructura."}),"\n",(0,s.jsx)(r.hr,{}),"\n",(0,s.jsx)(r.h2,{id:"7\ufe0f\u20e3-ejemplo-completo-lectura-robusta--guardado-seguro",children:(0,s.jsx)(r.strong,{children:"7\ufe0f\u20e3 Ejemplo completo: lectura robusta + guardado seguro"})}),"\n",(0,s.jsxs)(r.p,{children:["En este ejemplo se combinan tres ideas clave: ",(0,s.jsx)(r.strong,{children:"lectura defensiva"}),", ",(0,s.jsx)(r.strong,{children:"valor por defecto recuperable"})," y ",(0,s.jsx)(r.strong,{children:"escritura segura"}),"."]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-python",metastring:'title="Pipeline robusto"',children:'import json\nimport os\n\n\ndef cargar_eventos(ruta):\n    try:\n        with open(ruta, "r", encoding="utf-8") as f:\n            return json.load(f)\n    except (FileNotFoundError, json.JSONDecodeError):\n        return []\n\n\ndef guardar_resumen_seguro(ruta, resumen):\n    ruta_tmp = ruta + ".tmp"\n    with open(ruta_tmp, "w", encoding="utf-8") as f:\n        json.dump(resumen, f, indent=4, ensure_ascii=False)\n    os.replace(ruta_tmp, ruta)\n\n\neventos = cargar_eventos("eventos.json")\nresumen = {"total": len(eventos)}\nguardar_resumen_seguro("resumen.json", resumen)\n'})}),"\n",(0,s.jsxs)(r.blockquote,{children:["\n",(0,s.jsxs)(r.p,{children:["Flujo recomendado: ",(0,s.jsx)(r.strong,{children:"intentar -> capturar error espec\xedfico -> registrar -> recuperar o abortar de forma controlada"}),"."]}),"\n"]}),"\n",(0,s.jsx)(r.hr,{}),"\n",(0,s.jsx)(r.h2,{id:"-buenas-pr\xe1cticas-recomendadas",children:(0,s.jsx)(r.strong,{children:"\u2705 Buenas pr\xe1cticas recomendadas"})}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:"Captura excepciones espec\xedficas antes que gen\xe9ricas."}),"\n",(0,s.jsx)(r.li,{children:"Usa EAFP como patr\xf3n base en Python."}),"\n",(0,s.jsxs)(r.li,{children:["Registra errores con ",(0,s.jsx)(r.code,{children:"logging"}),", no solo con ",(0,s.jsx)(r.code,{children:"print"}),"."]}),"\n",(0,s.jsxs)(r.li,{children:["Usa escritura segura (",(0,s.jsx)(r.code,{children:"tmp"})," + ",(0,s.jsx)(r.code,{children:"os.replace"}),")."]}),"\n",(0,s.jsxs)(r.li,{children:["Limpia recursos auxiliares con ",(0,s.jsx)(r.code,{children:"finally"}),"."]}),"\n",(0,s.jsx)(r.li,{children:"Separa error t\xe9cnico (infraestructura) de decisi\xf3n de negocio."}),"\n"]}),"\n",(0,s.jsx)(r.hr,{}),"\n",(0,s.jsxs)(r.h2,{id:"-ejercicios-pr\xe1cticos--escudo-sentinel",children:[(0,s.jsx)(r.strong,{children:"\ud83e\uddea Ejercicios pr\xe1cticos"})," \u2013 Escudo Sentinel"]}),"\n",(0,s.jsx)(r.p,{children:"El sistema de persistencia est\xe1 operativo, pero ahora debes endurecerlo frente a fallos reales.\nTu misi\xf3n es detectar errores, registrar incidencias y garantizar consistencia de datos."}),"\n",(0,s.jsxs)(r.p,{children:["Dispones de estos ficheros: \ud83d\udc49 ",(0,s.jsx)(r.strong,{children:(0,s.jsx)(r.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:n(1999).A+"",children:"Desc\xe1rgalos aqu\xed"})})]}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"config_valida.json"})," -> configuraci\xf3n correcta"]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"config_corrupta.json"})," -> JSON inv\xe1lido"]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"eventos_incompletos.json"})," -> eventos con campos faltantes"]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"inventario_operativo.json"})," -> base de datos operativa"]}),"\n"]}),"\n",(0,s.jsx)(r.h3,{id:"-fase-1--diagn\xf3stico-de-errores",children:"\ud83d\udfe2 Fase 1 \u2013 Diagn\xf3stico de errores"}),"\n",(0,s.jsx)(r.h4,{id:"-ejercicio-1--carga-defensiva-de-configuraci\xf3n",children:"\ud83d\udfe9 Ejercicio 1 \u2013 Carga defensiva de configuraci\xf3n"}),"\n",(0,s.jsxs)(r.p,{children:["Implementa ",(0,s.jsx)(r.code,{children:"cargar_config_segura(ruta)"})," que:"]}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:"Devuelva el diccionario si es v\xe1lido."}),"\n",(0,s.jsxs)(r.li,{children:["Devuelva ",(0,s.jsx)(r.code,{children:"None"})," si no existe o si est\xe1 corrupto."]}),"\n",(0,s.jsx)(r.li,{children:"Muestre un mensaje distinto para cada caso."}),"\n"]}),"\n",(0,s.jsxs)(r.h4,{id:"-ejercicio-2--registro-de-incidencias-con-logging",children:["\ud83d\udfe6 Ejercicio 2 \u2013 Registro de incidencias con ",(0,s.jsx)(r.code,{children:"logging"})]}),"\n",(0,s.jsxs)(r.p,{children:["Configura ",(0,s.jsx)(r.code,{children:"logging"})," a fichero y registra:"]}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:["Error al abrir ",(0,s.jsx)(r.code,{children:"config_corrupta.json"}),"."]}),"\n",(0,s.jsxs)(r.li,{children:["Warning por evento sin ",(0,s.jsx)(r.code,{children:"tipo"})," en ",(0,s.jsx)(r.code,{children:"eventos_incompletos.json"}),"."]}),"\n"]}),"\n",(0,s.jsx)(r.p,{children:"Objetivo: dejar trazabilidad t\xe9cnica del proceso."}),"\n",(0,s.jsx)(r.h3,{id:"-fase-2--recuperaci\xf3n-segura",children:"\ud83d\udfe1 Fase 2 \u2013 Recuperaci\xf3n segura"}),"\n",(0,s.jsx)(r.h4,{id:"-ejercicio-3--guardado-at\xf3mico-de-resumen",children:"\ud83d\udfe8 Ejercicio 3 \u2013 Guardado at\xf3mico de resumen"}),"\n",(0,s.jsxs)(r.p,{children:["Genera ",(0,s.jsx)(r.code,{children:"resumen_eventos.json"})," con total de eventos v\xe1lidos usando patr\xf3n ",(0,s.jsx)(r.code,{children:"tmp + replace"}),"."]}),"\n",(0,s.jsx)(r.p,{children:"Condici\xf3n:"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:"Si ocurre error durante escritura, el archivo final previo no debe da\xf1arse."}),"\n"]}),"\n",(0,s.jsx)(r.h4,{id:"-ejercicio-4--backup-previo-del-inventario",children:"\ud83d\udfe7 Ejercicio 4 \u2013 Backup previo del inventario"}),"\n",(0,s.jsxs)(r.p,{children:["Antes de escribir cambios en ",(0,s.jsx)(r.code,{children:"inventario_operativo.json"}),":"]}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:["Crea ",(0,s.jsx)(r.code,{children:"inventario_operativo.backup.json"}),"."]}),"\n",(0,s.jsx)(r.li,{children:"Luego guarda la nueva versi\xf3n."}),"\n"]}),"\n",(0,s.jsx)(r.p,{children:"Objetivo: minimizar riesgo de p\xe9rdida irreversible."}),"\n",(0,s.jsx)(r.h3,{id:"-fase-3--limpieza-y-robustez",children:"\ud83d\udd35 Fase 3 \u2013 Limpieza y robustez"}),"\n",(0,s.jsxs)(r.h4,{id:"-ejercicio-5--limpieza-con-finally",children:["\ud83d\udfe5 Ejercicio 5 \u2013 Limpieza con ",(0,s.jsx)(r.code,{children:"finally"})]}),"\n",(0,s.jsxs)(r.p,{children:["Simula un proceso que crea ",(0,s.jsx)(r.code,{children:"proceso.tmp"})," y fuerza un error.\nAsegura que el archivo temporal se elimina siempre."]}),"\n",(0,s.jsx)(r.h4,{id:"-ejercicio-6--traducci\xf3n-de-errores-a-dominio",children:"\ud83d\udfeb Ejercicio 6 \u2013 Traducci\xf3n de errores a dominio"}),"\n",(0,s.jsxs)(r.p,{children:["Crea una excepci\xf3n ",(0,s.jsx)(r.code,{children:"PersistenciaError"})," y \xfasala para encapsular fallos t\xe9cnicos de lectura/escritura."]}),"\n",(0,s.jsx)(r.p,{children:"Objetivo: desacoplar infraestructura de negocio."}),"\n",(0,s.jsx)(r.h3,{id:"-fase-final--informe-de-resiliencia",children:"\ud83d\udd34 Fase Final \u2013 Informe de resiliencia"}),"\n",(0,s.jsxs)(r.h4,{id:"-ejercicio-7--informe-final-informe_resilienciatxt",children:["\ud83d\udfea Ejercicio 7 \u2013 Informe final (",(0,s.jsx)(r.code,{children:"informe_resiliencia.txt"}),")"]}),"\n",(0,s.jsx)(r.p,{children:"Genera un informe con:"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:"N\xfamero de errores capturados."}),"\n",(0,s.jsx)(r.li,{children:"N\xfamero de warnings registrados."}),"\n",(0,s.jsx)(r.li,{children:"N\xfamero de archivos recuperados correctamente."}),"\n",(0,s.jsxs)(r.li,{children:["Confirmaci\xf3n de que no quedan temporales (",(0,s.jsx)(r.code,{children:"*.tmp"}),")."]}),"\n"]}),"\n",(0,s.jsx)(r.p,{children:"Formato sugerido:"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-txt",children:"Errores capturados: X\nWarnings: X\nArchivos recuperados: X\nTemporales pendientes: 0\n"})})]})}function p(e={}){const{wrapper:r}={...(0,a.R)(),...e.components};return r?(0,s.jsx)(r,{...e,children:(0,s.jsx)(t,{...e})}):t(e)}},1999:(e,r,n)=>{n.d(r,{A:()=>i});const i=n.p+"assets/files/7_2_6_ficheros-aaf4d5efba0b1d9b771585acfce395af.zip"},8453:(e,r,n)=>{n.d(r,{R:()=>o,x:()=>c});var i=n(6540);const s={},a=i.createContext(s);function o(e){const r=i.useContext(a);return i.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function c(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),i.createElement(a.Provider,{value:r},e.children)}}}]);