"use strict";(self.webpackChunkp_my_dm=self.webpackChunkp_my_dm||[]).push([[824],{23774:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>d,contentTitle:()=>s,default:()=>u,frontMatter:()=>o,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"aplicaciones m\xf3viles/5 Persistencia/FireBase/Autentication/ejemplo","title":"Ejemplo Email-Password","description":"A continuaci\xf3n, describimos los pasos para crear una app muy b\xe1sica donde el usuario pueda registrarse e iniciar sesi\xf3n con correo y contrase\xf1a usando Firebase Authentication. La aplicaci\xf3n contendr\xe1 2 Activities, una donde podremos logarnos o registrarnos y la otra nos dar\xe1 la bienvenida indicando si el usuario es nuevo o antiguo.","source":"@site/docs/aplicaciones m\xf3viles/5 Persistencia/FireBase/Autentication/ejemplo.md","sourceDirName":"aplicaciones m\xf3viles/5 Persistencia/FireBase/Autentication","slug":"/aplicaciones m\xf3viles/5 Persistencia/FireBase/Autentication/ejemplo","permalink":"/docs/aplicaciones m\xf3viles/5 Persistencia/FireBase/Autentication/ejemplo","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"movilesSidebar","previous":{"title":"C\xf3digo de integraci\xf3n en Android","permalink":"/docs/aplicaciones m\xf3viles/5 Persistencia/FireBase/Autentication/integracion"},"next":{"title":"Ejemplo Google-LogIn","permalink":"/docs/aplicaciones m\xf3viles/5 Persistencia/FireBase/Autentication/google"}}');var t=r(74848),a=r(28453);const o={sidebar_position:3},s="Ejemplo Email-Password",d={},l=[{value:"1. <strong>Crear el proyecto en Android Studio</strong>",id:"1-crear-el-proyecto-en-android-studio",level:2},{value:"2. <strong>Configurar Firebase</strong>",id:"2-configurar-firebase",level:2},{value:"3. <strong>Dise\xf1ar las interfaces</strong>",id:"3-dise\xf1ar-las-interfaces",level:2},{value:"Layout Registro",id:"layout-registro",level:3},{value:"Layout Principal",id:"layout-principal",level:3},{value:"4. <strong>Programar las Activities</strong>",id:"4-programar-las-activities",level:2},{value:"Actividad Registro",id:"actividad-registro",level:3},{value:"Actividad Principal",id:"actividad-principal",level:3},{value:"5. <strong>Modifica el AndroidManifest</strong>",id:"5-modifica-el-androidmanifest",level:2},{value:"<strong>Prueba la aplicaci\xf3n</strong>",id:"prueba-la-aplicaci\xf3n",level:2}];function c(n){const e={admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...n.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.header,{children:(0,t.jsx)(e.h1,{id:"ejemplo-email-password",children:"Ejemplo Email-Password"})}),"\n",(0,t.jsxs)(e.p,{children:["A continuaci\xf3n, describimos los pasos para crear una app muy b\xe1sica donde el usuario pueda ",(0,t.jsx)(e.strong,{children:"registrarse"})," e ",(0,t.jsx)(e.strong,{children:"iniciar sesi\xf3n"})," con ",(0,t.jsx)(e.strong,{children:"correo y contrase\xf1a"})," usando Firebase Authentication. La aplicaci\xf3n contendr\xe1 2 Activities, una donde podremos logarnos o registrarnos y la otra nos dar\xe1 la bienvenida indicando si el usuario es nuevo o antiguo."]}),"\n",(0,t.jsx)("div",{style:{margin:"0 auto",width:"250px"},children:(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{alt:"Presentaci\xf3n de la 1\xaa version de la app de autenticaci\xf3n",src:r(35225).A+"",title:"Presentaci\xf3n de la 1\xaa version de la app de autenticaci\xf3n",width:"365",height:"812"})})}),"\n",(0,t.jsxs)(e.h2,{id:"1-crear-el-proyecto-en-android-studio",children:["1. ",(0,t.jsx)(e.strong,{children:"Crear el proyecto en Android Studio"})]}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["Selecciona ",(0,t.jsx)(e.strong,{children:"File > New > New Project"}),"."]}),"\n",(0,t.jsx)(e.li,{children:"Escoge una plantilla vac\xeda (Empty Activity)."}),"\n",(0,t.jsx)(e.li,{children:"Configura el nombre del proyecto y el paquete."}),"\n"]}),"\n",(0,t.jsxs)(e.admonition,{title:"API LEVEL",type:"warning",children:[(0,t.jsx)(e.p,{children:"La versi\xf3n m\xednima (minSdkVersion) recomendada para utilizar la mayor\xeda de las bibliotecas de Firebase en Android suele ser API 19 (Android 4.4 \u2013 KitKat)."}),(0,t.jsxs)(e.p,{children:["Sin embargo, no todas las bibliotecas de Firebase tienen exactamente el mismo requisito, ya que algunas pueden funcionar con una API inferior (por ejemplo, API 16) y otras pueden requerir API 19 o superior. En general, si usas la \xfaltima versi\xf3n de las bibliotecas de Firebase, lo m\xe1s seguro es establecer ",(0,t.jsx)(e.strong,{children:"minSdkVersion en 28"})," para evitar incompatibilidades."]})]}),"\n",(0,t.jsxs)(e.h2,{id:"2-configurar-firebase",children:["2. ",(0,t.jsx)(e.strong,{children:"Configurar Firebase"})]}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["Sigue los pasos de la secci\xf3n configuraci\xf3n (descargar ",(0,t.jsx)(e.code,{children:"google-services.json"}),", habilitar Email/Password en la consola de Firebase, etc.)."]}),"\n"]}),"\n",(0,t.jsxs)(e.h2,{id:"3-dise\xf1ar-las-interfaces",children:["3. ",(0,t.jsx)(e.strong,{children:"Dise\xf1ar las interfaces"})]}),"\n",(0,t.jsx)(e.p,{children:"Deberemos dise\xf1ar dos layouts:"}),"\n",(0,t.jsx)(e.h3,{id:"layout-registro",children:"Layout Registro"}),"\n",(0,t.jsxs)(e.p,{children:["En el ",(0,t.jsx)(e.strong,{children:"layout de la actividad de registro"})," tendremos el campo email y contrase\xf1a. Ademas tendremos un boton para el login y otro para el registro:"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-xml",metastring:'title="res/layout/activity_registro.xml"',children:'<?xml version="1.0" encoding="utf-8"?>\r\n<androidx.constraintlayout.widget.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android"\r\n  xmlns:app="http://schemas.android.com/apk/res-auto"\r\n  xmlns:tools="http://schemas.android.com/tools"\r\n  android:id="@+id/linearLayout"\r\n  android:layout_width="match_parent"\r\n  android:layout_height="match_parent"\r\n  android:gravity="center">\r\n\r\n  <com.google.android.material.textfield.TextInputLayout\r\n      android:id="@+id/textInputLayout"\r\n      android:layout_width="0dp"\r\n      android:layout_height="wrap_content"\r\n      android:layout_marginStart="32dp"\r\n      android:layout_marginTop="50dp"\r\n      android:layout_marginEnd="32dp"\r\n      app:layout_constraintEnd_toEndOf="parent"\r\n      app:layout_constraintStart_toStartOf="parent"\r\n      app:layout_constraintTop_toTopOf="parent">\r\n\r\n      <com.google.android.material.textfield.TextInputEditText\r\n          android:id="@+id/textoMail"\r\n          android:layout_width="match_parent"\r\n          android:layout_height="wrap_content"\r\n          android:hint="Email" />\r\n\r\n  </com.google.android.material.textfield.TextInputLayout>\r\n\r\n  <com.google.android.material.textfield.TextInputLayout\r\n      android:id="@+id/textInputLayout2"\r\n      android:layout_width="match_parent"\r\n      android:layout_height="wrap_content"\r\n      android:layout_marginStart="32dp"\r\n      android:layout_marginTop="32dp"\r\n      android:layout_marginEnd="32dp"\r\n      app:layout_constraintEnd_toEndOf="parent"\r\n      app:layout_constraintStart_toStartOf="parent"\r\n      app:layout_constraintTop_toBottomOf="@+id/textInputLayout">\r\n\r\n      <EditText\r\n          android:id="@+id/textoPassword"\r\n          android:layout_width="match_parent"\r\n          android:layout_height="wrap_content"\r\n          android:layout_weight="1"\r\n          android:ems="10"\r\n          android:hint="Contrase\xf1a"\r\n          android:inputType="textPassword" />\r\n  </com.google.android.material.textfield.TextInputLayout>\r\n\r\n  <Button\r\n      android:id="@+id/btnLogin"\r\n      android:layout_width="wrap_content"\r\n      android:layout_height="wrap_content"\r\n      android:layout_marginTop="24dp"\r\n      android:text="Iniciar Sesi\xf3n"\r\n      app:layout_constraintEnd_toEndOf="parent"\r\n      app:layout_constraintStart_toStartOf="parent"\r\n      app:layout_constraintTop_toBottomOf="@+id/textInputLayout2" />\r\n\r\n  <com.google.android.material.textfield.TextInputLayout\r\n      android:id="@+id/textInputLayout3"\r\n      android:layout_width="match_parent"\r\n      android:layout_height="wrap_content"\r\n      android:layout_marginStart="32dp"\r\n      android:layout_marginTop="60dp"\r\n      android:layout_marginEnd="32dp"\r\n      app:layout_constraintEnd_toEndOf="parent"\r\n      app:layout_constraintHorizontal_bias="0.0"\r\n      app:layout_constraintStart_toStartOf="parent"\r\n      app:layout_constraintTop_toBottomOf="@+id/btnLogin">\r\n\r\n      <EditText\r\n          android:id="@+id/textoPassword2"\r\n          android:layout_width="match_parent"\r\n          android:layout_height="wrap_content"\r\n          android:layout_weight="1"\r\n          android:ems="10"\r\n          android:hint="Confirmar Contrase\xf1a"\r\n          android:inputType="textPassword" />\r\n  </com.google.android.material.textfield.TextInputLayout>\r\n\r\n  <Button\r\n      android:id="@+id/btnRegistro"\r\n      android:layout_width="wrap_content"\r\n      android:layout_height="wrap_content"\r\n      android:layout_marginTop="24dp"\r\n      android:text="Registrarse"\r\n      app:layout_constraintEnd_toEndOf="parent"\r\n      app:layout_constraintStart_toStartOf="parent"\r\n      app:layout_constraintTop_toBottomOf="@+id/textInputLayout3" />\r\n\r\n</androidx.constraintlayout.widget.ConstraintLayout>\n'})}),"\n",(0,t.jsx)(e.h3,{id:"layout-principal",children:"Layout Principal"}),"\n",(0,t.jsxs)(e.p,{children:["En el ",(0,t.jsx)(e.strong,{children:"layout principal"}),", crearemos un layout sencillo para mostrar los datos del usuario y un bot\xf3n de logout."]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-xml",metastring:'title="res/layout/activity_main.xml"',children:'<?xml version="1.0" encoding="utf-8"?>\r\n<androidx.constraintlayout.widget.ConstraintLayout\r\n xmlns:android="http://schemas.android.com/apk/res/android"\r\n xmlns:app="http://schemas.android.com/apk/res-auto"\r\n xmlns:tools="http://schemas.android.com/tools"\r\n android:id="@+id/mainLayout"\r\n android:layout_width="match_parent"\r\n android:layout_height="match_parent"\r\n tools:context=".MainActivity"\r\n android:padding="16dp">\r\n\r\n <TextView\r\n     android:id="@+id/textViewUserInfo"\r\n     android:layout_width="0dp"\r\n     android:layout_height="wrap_content"\r\n     android:layout_marginTop="8dp"\r\n     android:text="Informaci\xf3n del Usuario"\r\n     android:textSize="18sp"\r\n     app:layout_constraintBottom_toTopOf="@+id/buttonLogout"\r\n     app:layout_constraintEnd_toEndOf="parent"\r\n     app:layout_constraintHorizontal_bias="0.0"\r\n     app:layout_constraintStart_toStartOf="parent"\r\n     app:layout_constraintTop_toBottomOf="@+id/textView"\r\n     app:layout_constraintVertical_bias="0.3" />\r\n\r\n <TextView\r\n     android:id="@+id/textViewUserInfo2"\r\n     android:layout_width="0dp"\r\n     android:layout_height="wrap_content"\r\n     android:layout_marginTop="8dp"\r\n     android:text="Informaci\xf3n del Usuario"\r\n     android:textSize="18sp"\r\n     app:layout_constraintBottom_toTopOf="@+id/buttonLogout"\r\n     app:layout_constraintEnd_toEndOf="parent"\r\n     app:layout_constraintHorizontal_bias="0.0"\r\n     app:layout_constraintStart_toStartOf="parent"\r\n     app:layout_constraintTop_toBottomOf="@+id/textView2"\r\n     app:layout_constraintVertical_bias="0.196" />\r\n\r\n <TextView\r\n     android:id="@+id/textViewUserInfo3"\r\n     android:layout_width="0dp"\r\n     android:layout_height="wrap_content"\r\n     android:text="Informaci\xf3n del Usuario"\r\n     android:textSize="18sp"\r\n     app:layout_constraintBottom_toTopOf="@+id/buttonLogout"\r\n     app:layout_constraintEnd_toEndOf="parent"\r\n     app:layout_constraintHorizontal_bias="0.0"\r\n     app:layout_constraintStart_toStartOf="parent"\r\n     app:layout_constraintTop_toBottomOf="@+id/textViewUserInfo2"\r\n     app:layout_constraintVertical_bias="0.468" />\r\n\r\n <Button\r\n     android:id="@+id/buttonLogout"\r\n     android:layout_width="wrap_content"\r\n     android:layout_height="wrap_content"\r\n     android:layout_marginTop="160dp"\r\n     android:text="Cerrar Sesi\xf3n"\r\n     app:layout_constraintEnd_toEndOf="parent"\r\n     app:layout_constraintHorizontal_bias="0.497"\r\n     app:layout_constraintStart_toStartOf="parent"\r\n     app:layout_constraintTop_toBottomOf="@+id/textViewUserInfo" />\r\n\r\n <TextView\r\n     android:id="@+id/textView"\r\n     android:layout_width="111dp"\r\n     android:layout_height="23dp"\r\n     android:layout_marginTop="168dp"\r\n     android:text="Usuario:"\r\n     android:textSize="20sp"\r\n     android:textStyle="bold"\r\n     app:layout_constraintEnd_toEndOf="parent"\r\n     app:layout_constraintHorizontal_bias="0.0"\r\n     app:layout_constraintStart_toStartOf="parent"\r\n     app:layout_constraintTop_toTopOf="parent" />\r\n\r\n <TextView\r\n     android:id="@+id/textView2"\r\n     android:layout_width="171dp"\r\n     android:layout_height="25dp"\r\n     android:layout_marginTop="16dp"\r\n     android:text="Info Usuario:"\r\n     android:textSize="20sp"\r\n     android:textStyle="bold"\r\n     app:layout_constraintEnd_toEndOf="parent"\r\n     app:layout_constraintHorizontal_bias="0.0"\r\n     app:layout_constraintStart_toStartOf="parent"\r\n     app:layout_constraintTop_toBottomOf="@+id/textViewUserInfo" />\r\n\r\n</androidx.constraintlayout.widget.ConstraintLayout>\r\n\n'})}),"\n",(0,t.jsxs)(e.h2,{id:"4-programar-las-activities",children:["4. ",(0,t.jsx)(e.strong,{children:"Programar las Activities"})]}),"\n",(0,t.jsx)(e.h3,{id:"actividad-registro",children:"Actividad Registro"}),"\n",(0,t.jsxs)(e.p,{children:["Esta ser\xe1 la actividad que permita al usuario hacer LogIn o Registrarse. Crea la clase  ",(0,t.jsx)(e.code,{children:"RegistroActivity.java"})," y escribe el siguiente c\xf3digo:"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",metastring:'title="RegistroActivity.java"',children:'package com.agora.autenticaciondemo;\r\n\r\nimport androidx.annotation.NonNull;\r\nimport androidx.appcompat.app.AppCompatActivity;\r\n\r\nimport android.content.Intent;\r\nimport android.os.Bundle;\r\nimport android.view.View;\r\nimport android.widget.Toast;\r\n\r\nimport com.agora.autenticaciondemo.databinding.ActivityRegistroBinding;\r\nimport com.google.android.gms.tasks.OnCompleteListener;\r\nimport com.google.android.gms.tasks.Task;\r\nimport com.google.firebase.FirebaseApp;\r\nimport com.google.firebase.auth.AuthResult;\r\nimport com.google.firebase.auth.FirebaseAuth;\r\nimport com.google.firebase.auth.FirebaseUser;\r\n\r\n/**\r\n* RegisterActivity maneja el registro e inicio de sesi\xf3n con Firebase Authentication.\r\n*/\r\npublic class RegistroActivity extends AppCompatActivity {\r\n\r\n private ActivityRegistroBinding binding;\r\n private FirebaseAuth mAuth;\r\n\r\n @Override\r\n protected void onCreate(Bundle savedInstanceState) {\r\n     super.onCreate(savedInstanceState);\r\n     // Inicializamos View Binding\r\n     binding = ActivityRegistroBinding.inflate(getLayoutInflater());\r\n     setContentView(binding.getRoot());\r\n\r\n     // Inicializar Firebase\r\n     FirebaseApp.initializeApp(this);\r\n     mAuth = FirebaseAuth.getInstance();\r\n\r\n     // Click en "Iniciar Sesi\xf3n"\r\n     binding.btnLogin.setOnClickListener(new View.OnClickListener() {\r\n         @Override\r\n         public void onClick(View view) {\r\n             logarUsuario();\r\n         }\r\n     });\r\n\r\n     // Click en "Registrarse"\r\n     binding.btnRegistro.setOnClickListener(new View.OnClickListener() {\r\n         @Override\r\n         public void onClick(View view) {\r\n             crearUsuario();\r\n         }\r\n     });\r\n }\r\n\r\n /**\r\n  * Crea un nuevo usuario en Firebase (Email/Password).\r\n  */\r\n private void crearUsuario() {\r\n     String email = binding.textoMail.getText().toString().trim();\r\n     String password = binding.textoPassword.getText().toString().trim();\r\n     String password2 = binding.textoPassword2.getText().toString().trim();\r\n\r\n     if (email.isEmpty() || password.isEmpty() || password2.isEmpty()) {\r\n         Toast.makeText(this, "Por favor, completa todos los campos", Toast.LENGTH_SHORT).show();\r\n         return;\r\n     } else if (!password.equals(password2)) {\r\n         Toast.makeText(this, "Las contrase\xf1as no coinciden", Toast.LENGTH_SHORT).show();\r\n         return;\r\n     }\r\n\r\n     mAuth.createUserWithEmailAndPassword(email, password)\r\n             .addOnCompleteListener(this, new OnCompleteListener<AuthResult>() {\r\n                 @Override\r\n                 public void onComplete(@NonNull Task<AuthResult> task) {\r\n                     if (task.isSuccessful()) {\r\n                         // Usuario creado por primera vez\r\n                         FirebaseUser usuario = mAuth.getCurrentUser();\r\n                         if (usuario != null) {\r\n                             Toast.makeText(RegistroActivity.this,\r\n                                     "Bienvenido, nuevo usuario: " + usuario.getEmail(),\r\n                                     Toast.LENGTH_SHORT).show();\r\n                         }\r\n                         // Pasamos a la actividad principal\r\n                         iniciarMainActivity();\r\n                     } else {\r\n                         // Falla en la creaci\xf3n de usuario (e.g., email ya en uso)\r\n                         Toast.makeText(RegistroActivity.this,\r\n                                 "Error al crear usuario: " + task.getException().getMessage(),\r\n                                 Toast.LENGTH_SHORT).show();\r\n                     }\r\n                 }\r\n             });\r\n }\r\n\r\n /**\r\n  * Inicia sesi\xf3n con un usuario existente.\r\n  */\r\n private void logarUsuario() {\r\n     String email = binding.textoMail.getText().toString().trim();\r\n     String password = binding.textoPassword.getText().toString().trim();\r\n\r\n     if (email.isEmpty() || password.isEmpty()) {\r\n         Toast.makeText(this, "Por favor, completa todos los campos", Toast.LENGTH_SHORT).show();\r\n         return;\r\n     }\r\n\r\n     mAuth.signInWithEmailAndPassword(email, password)\r\n             .addOnCompleteListener(this, new OnCompleteListener<AuthResult>() {\r\n                 @Override\r\n                 public void onComplete(@NonNull Task<AuthResult> task) {\r\n                     if (task.isSuccessful()) {\r\n                         // Usuario existente\r\n                         FirebaseUser usuario = mAuth.getCurrentUser();\r\n                         if (usuario != null) {\r\n                             Toast.makeText(RegistroActivity.this,\r\n                                     "Bienvenido de nuevo: " + usuario.getEmail(),\r\n                                     Toast.LENGTH_SHORT).show();\r\n                         }\r\n                         // Pasamos a la actividad principal\r\n                         iniciarMainActivity();\r\n                     } else {\r\n                         // Error al iniciar sesi\xf3n\r\n                         Toast.makeText(RegistroActivity.this,\r\n                                 "Error al iniciar sesi\xf3n: " + task.getException().getMessage(),\r\n                                 Toast.LENGTH_SHORT).show();\r\n                     }\r\n                 }\r\n             });\r\n }\r\n\r\n /**\r\n  * Navega a la MainActivity\r\n  */\r\n private void iniciarMainActivity() {\r\n     Intent intent = new Intent(RegistroActivity.this, MainActivity.class);\r\n     startActivity(intent);\r\n     finish();\r\n }\r\n}\r\n\n'})}),"\n",(0,t.jsxs)(e.admonition,{title:"create User With Email And Password",type:"info",children:[(0,t.jsxs)(e.p,{children:["Esta funci\xf3n es el ",(0,t.jsx)(e.strong,{children:"proceso de registro"})," de un usuario con ",(0,t.jsx)(e.strong,{children:"Firebase Authentication"})," empleando ",(0,t.jsx)(e.strong,{children:"correo y contrase\xf1a"}),". Este m\xe9todo es parte de ",(0,t.jsx)(e.strong,{children:"Firebase Authentication"})," y permite, de forma r\xe1pida, implementar ",(0,t.jsx)(e.strong,{children:"registro"})," en tu aplicaci\xf3n Android sin tener que crear tu propio servidor de autenticaci\xf3n ni manejar contrase\xf1as en tu backend.\r\nVe\xe1mosla ",(0,t.jsx)(e.strong,{children:"paso a paso"}),":"]}),(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:(0,t.jsx)(e.code,{children:"mAuth.createUserWithEmailAndPassword(email, password)"})})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["Llama al m\xe9todo de ",(0,t.jsx)(e.strong,{children:"FirebaseAuth"})," para ",(0,t.jsx)(e.strong,{children:"crear"})," un usuario nuevo usando ",(0,t.jsx)(e.strong,{children:"correo"})," y ",(0,t.jsx)(e.strong,{children:"contrase\xf1a"}),"."]}),"\n",(0,t.jsxs)(e.li,{children:["Devuelve un objeto de tipo ",(0,t.jsx)(e.code,{children:"Task<AuthResult>"})," que representa la ",(0,t.jsx)(e.strong,{children:"operaci\xf3n as\xedncrona"})," (ocurre en segundo plano)."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:(0,t.jsx)(e.code,{children:"addOnCompleteListener(this, new OnCompleteListener<AuthResult>() {...})"})})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["Se registra un ",(0,t.jsx)(e.em,{children:"listener"})," que se invoca ",(0,t.jsx)(e.strong,{children:"cuando la operaci\xf3n termine"})," (se complete)."]}),"\n",(0,t.jsxs)(e.li,{children:["El primer par\xe1metro (",(0,t.jsx)(e.code,{children:"this"}),") indica el ",(0,t.jsx)(e.strong,{children:"Context"})," o ",(0,t.jsx)(e.strong,{children:"LifecycleOwner"})," que escucha el resultado (en este caso, la ",(0,t.jsx)(e.code,{children:"Activity"})," actual)."]}),"\n",(0,t.jsxs)(e.li,{children:["El segundo par\xe1metro es el ",(0,t.jsx)(e.strong,{children:"c\xf3digo"})," que se ejecutar\xe1 una vez que la tarea (registro) ",(0,t.jsx)(e.strong,{children:"finalice"})," (exitosamente o con error)."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:(0,t.jsx)(e.code,{children:"onComplete(@NonNull Task<AuthResult> task)"})})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["Este m\xe9todo se ",(0,t.jsx)(e.strong,{children:"dispara"})," al ",(0,t.jsx)(e.strong,{children:"terminar"})," la creaci\xf3n del usuario."]}),"\n",(0,t.jsxs)(e.li,{children:["El objeto ",(0,t.jsx)(e.code,{children:"task"})," contiene informaci\xf3n del resultado (si fue exitoso o no)."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:(0,t.jsx)(e.code,{children:"if (task.isSuccessful()) { ... } else { ... }"})})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["Se verifica si la operaci\xf3n fue ",(0,t.jsx)(e.strong,{children:"exitosa"})," o ",(0,t.jsx)(e.strong,{children:"fall\xf3"}),"."]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.code,{children:"task.isSuccessful()"})," retornar\xe1 ",(0,t.jsx)(e.code,{children:"true"})," si el registro se efectu\xf3 correctamente."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"Cuando es exitoso"})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["Se obtiene el usuario reci\xe9n creado con ",(0,t.jsx)(e.code,{children:"mAuth.getCurrentUser()"}),"."]}),"\n",(0,t.jsxs)(e.li,{children:["Si no es ",(0,t.jsx)(e.code,{children:"null"}),", se muestra un mensaje de bienvenida que incluye su email."]}),"\n",(0,t.jsxs)(e.li,{children:["Despu\xe9s, se llama a ",(0,t.jsx)(e.code,{children:"iniciarMainActivity()"})," para cambiar a la siguiente pantalla (por ejemplo, la pantalla principal de la app)."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"Cuando falla"})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["Se muestra un mensaje de error que incluye la descripci\xf3n de la excepci\xf3n: ",(0,t.jsx)(e.code,{children:"task.getException().getMessage()"}),"."]}),"\n",(0,t.jsx)(e.li,{children:"Una de las causas comunes de error podr\xeda ser que el email ya est\xe9 en uso o que no cumpla con el formato requerido por Firebase."}),"\n"]}),"\n"]}),"\n"]})]}),"\n",(0,t.jsxs)(e.admonition,{title:"sign In With Email And Password",type:"info",children:[(0,t.jsxs)(e.p,{children:["Este m\xe9todo es clave para ",(0,t.jsx)(e.strong,{children:"iniciar sesi\xf3n"})," con ",(0,t.jsx)(e.strong,{children:"Firebase Authentication"}),", permitiendo a los usuarios que ",(0,t.jsx)(e.strong,{children:"ya se registraron"})," acceder a tu aplicaci\xf3n de forma segura."]}),(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:(0,t.jsx)(e.code,{children:"mAuth.signInWithEmailAndPassword(email, password)"})})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["Este m\xe9todo de ",(0,t.jsx)(e.strong,{children:"FirebaseAuth"})," realiza la ",(0,t.jsx)(e.strong,{children:"autenticaci\xf3n"})," de un ",(0,t.jsx)(e.strong,{children:"usuario existente"})," con las credenciales suministradas (email y contrase\xf1a)."]}),"\n",(0,t.jsxs)(e.li,{children:["Regresa un objeto ",(0,t.jsx)(e.code,{children:"Task<AuthResult>"})," para manejar la operaci\xf3n de manera as\xedncrona (ocurre en segundo plano)."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:(0,t.jsx)(e.code,{children:"addOnCompleteListener(this, new OnCompleteListener<AuthResult>() { ... })"})})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["Se registra un ",(0,t.jsx)(e.em,{children:"listener"})," que se ejecutar\xe1 ",(0,t.jsx)(e.strong,{children:"al finalizar"})," la operaci\xf3n (ya sea con \xe9xito o error)."]}),"\n",(0,t.jsxs)(e.li,{children:["El primer par\xe1metro (",(0,t.jsx)(e.code,{children:"this"}),") indica el ",(0,t.jsx)(e.strong,{children:"Context"})," de la Activity que escucha la respuesta."]}),"\n",(0,t.jsxs)(e.li,{children:["Dentro del ",(0,t.jsx)(e.em,{children:"listener"})," se define el comportamiento en ",(0,t.jsx)(e.code,{children:"onComplete"}),"."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:(0,t.jsx)(e.code,{children:"onComplete(@NonNull Task<AuthResult> task)"})})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["Se invoca ",(0,t.jsx)(e.strong,{children:"cuando"})," la tarea concluye."]}),"\n",(0,t.jsxs)(e.li,{children:["El objeto ",(0,t.jsx)(e.code,{children:"task"})," contiene la informaci\xf3n sobre el resultado de la autenticaci\xf3n (\xe9xito o fallo)."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:(0,t.jsx)(e.code,{children:"if (task.isSuccessful()) { ... } else { ... }"})})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["Se pregunta si la autenticaci\xf3n fue ",(0,t.jsx)(e.strong,{children:"exitosa"}),"."]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.code,{children:"task.isSuccessful()"})," retorna ",(0,t.jsx)(e.code,{children:"true"})," cuando el login con email y contrase\xf1a se realiza correctamente."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"Si la autenticaci\xf3n es exitosa"})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["Se obtiene el usuario autenticado con ",(0,t.jsx)(e.code,{children:"mAuth.getCurrentUser()"}),"."]}),"\n",(0,t.jsxs)(e.li,{children:["Si no es ",(0,t.jsx)(e.code,{children:"null"}),", se muestra un mensaje personalizado: \u201cBienvenido de nuevo: \u2026\u201d."]}),"\n",(0,t.jsxs)(e.li,{children:["Despu\xe9s, se llama a ",(0,t.jsx)(e.code,{children:"iniciarMainActivity()"})," para redirigir a la siguiente pantalla (por ejemplo, la principal de la app)."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"Si la autenticaci\xf3n falla"})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["Se muestra un ",(0,t.jsx)(e.code,{children:"Toast"})," con el mensaje de error: ",(0,t.jsx)(e.code,{children:"task.getException().getMessage()"}),"."]}),"\n",(0,t.jsx)(e.li,{children:"Algunas razones comunes pueden ser credenciales inv\xe1lidas (contrase\xf1a incorrecta), email no registrado, etc."}),"\n"]}),"\n"]}),"\n"]})]}),"\n",(0,t.jsx)(e.h3,{id:"actividad-principal",children:"Actividad Principal"}),"\n",(0,t.jsxs)(e.p,{children:["Crea la clase  ",(0,t.jsx)(e.code,{children:"MainActivity.java"})," para mostrar la informaci\xf3n del usuario y un bot\xf3n de logout. Tambi\xe9n cerraremos sesi\xf3n autom\xe1ticamente al salir de la app."]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",metastring:'title="MainActivity.java"',children:'package com.agora.autenticaciondemo;\r\n\r\nimport androidx.appcompat.app.AppCompatActivity;\r\n\r\nimport android.content.Intent;\r\nimport android.os.Bundle;\r\nimport android.util.Log;\r\nimport android.view.View;\r\nimport android.widget.Toast;\r\n\r\nimport com.agora.autenticaciondemo.databinding.ActivityMainBinding;\r\nimport com.google.firebase.auth.FirebaseAuth;\r\nimport com.google.firebase.auth.FirebaseUser;\r\nimport com.google.firebase.auth.FirebaseUserMetadata;\r\n\r\nimport java.util.Date;\r\n\r\n/**\r\n * MainActivity muestra informaci\xf3n del usuario y permite cerrar sesi\xf3n.\r\n */\r\npublic class MainActivity extends AppCompatActivity {\r\n\r\n    // View Binding para activity_main.xml\r\n    private ActivityMainBinding binding;\r\n\r\n    // Referencia a FirebaseAuth\r\n    private FirebaseAuth mAuth;\r\n\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n\r\n        // Inicializamos el binding\r\n        binding = ActivityMainBinding.inflate(getLayoutInflater());\r\n        View view = binding.getRoot();\r\n        setContentView(view);\r\n\r\n        // Obtener instancia de FirebaseAuth\r\n        mAuth = FirebaseAuth.getInstance();\r\n\r\n        // Verificar si hay un usuario logueado\r\n        FirebaseUser usuarioActual = mAuth.getCurrentUser();\r\n        if (usuarioActual == null) {\r\n            // Si no hay usuario, volvemos a RegistroActivity\r\n            volverRegistro();\r\n        } else {\r\n            //Mostramos email del usuario\r\n            binding.textViewUserInfo.setText(usuarioActual.getEmail());\r\n            // Obtener la metadata del usuario\r\n            // highlight-start\r\n            FirebaseUserMetadata metadata = usuarioActual.getMetadata();\r\n            // highlight-end\r\n            if (metadata != null) {\r\n                // Obtener la fecha de creaci\xf3n y \xfaltimo inicio de sesi\xf3n\r\n                    long creationTime = metadata.getCreationTimestamp();      // Milisegundos desde la \xe9poca Unix\r\n                    long lastSignInTime = metadata.getLastSignInTimestamp();  // Milisegundos desde la \xe9poca Unix\r\n                    // Para mostrarlo de forma legible, podemos convertirlo a Date:\r\n                    Date creationDate = new Date(creationTime);\r\n                    Date lastSignInDate = new Date(lastSignInTime);\r\n                //Mostramos informaci\xf3n del usuario\r\n                    binding.textViewUserInfo2.setText("Cuenta creada: " + creationDate.toString());\r\n                    binding.textViewUserInfo3.setText("\xdaltima sesi\xf3n: " + lastSignInDate.toString());\r\n              }\r\n        }\r\n\r\n        // Evento para bot\xf3n "Cerrar Sesi\xf3n"\r\n        binding.buttonLogout.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View view) {\r\n                signOutUsuario();\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Cierra la sesi\xf3n del usuario.\r\n     */\r\n    private void signOutUsuario() {\r\n        mAuth.signOut();\r\n        Toast.makeText(MainActivity.this, "Sesi\xf3n cerrada", Toast.LENGTH_SHORT).show();\r\n\r\n        // Volver a la pantalla de registro/inicio\r\n        volverRegistro();\r\n    }\r\n\r\n    /**\r\n     * Navegar a RegisterActivity.\r\n     */\r\n    private void volverRegistro() {\r\n        Intent intent = new Intent(MainActivity.this, RegistroActivity.class);\r\n        startActivity(intent);\r\n        finish(); // Cerramos la actividad actual\r\n    }\r\n\r\n    /**\r\n     * Cuando el usuario sale de la app (onDestroy se llama cuando la Activity se destruye),\r\n     * cerramos sesi\xf3n autom\xe1ticamente seg\xfan la solicitud.\r\n     */\r\n    @Override\r\n    protected void onDestroy() {\r\n        super.onDestroy();\r\n        // Cerrar sesi\xf3n autom\xe1ticamente al destruir la Activity (salir de la app)\r\n        mAuth.signOut();\r\n    }\r\n}\r\n\r\n\n'})}),"\n",(0,t.jsxs)(e.admonition,{title:"get metadata",type:"info",children:[(0,t.jsxs)(e.p,{children:["El m\xe9todo ",(0,t.jsx)(e.code,{children:"getMetadata()"})," se llama sobre un objeto de tipo FirebaseUser y devuelve un objeto de tipo FirebaseUserMetadata. El objeto ",(0,t.jsx)(e.code,{children:"FirebaseUserMetadata"})," proporciona dos valores principales relacionados con la cuenta del usuario:"]}),(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Creation Timestamp"})," (",(0,t.jsx)(e.code,{children:"getCreationTimestamp()"}),"): Es un valor en milisegundos que indica cu\xe1ndo se cre\xf3 la cuenta por primera vez en Firebase (momento del registro)."]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Last Sign-In Timestamp"})," (",(0,t.jsx)(e.code,{children:"getLastSignInTimestamp()"}),")",":Tambi","\xe9n es un valor en milisegundos que indica cu\xe1ndo fue la \xfaltima vez que el usuario inici\xf3 sesi\xf3n exitosamente."]}),"\n"]})]}),"\n",(0,t.jsx)(e.admonition,{title:"onDestroy vs. onStop",type:"warning",children:(0,t.jsxs)(e.p,{children:["Aqu\xed usamos ",(0,t.jsx)(e.strong,{children:"onDestroy()"})," para cerrar la sesi\xf3n cuando la actividad principal se destruye. Dependiendo del ciclo de vida y del dispositivo (por ejemplo, rotaciones de pantalla), onDestroy() puede ser llamado en otras circunstancias.\r\nSi prefieres, podr\xedas implementar este cierre de sesi\xf3n en ",(0,t.jsx)(e.strong,{children:"onStop()"})," o manejarlo seg\xfan la l\xf3gica de tu aplicaci\xf3n para evitar efectos inesperados (por ejemplo, si el usuario gira la pantalla se recrea la actividad y volver\xeda a RegisterActivity)."]})}),"\n",(0,t.jsx)(e.hr,{}),"\n",(0,t.jsxs)(e.h2,{id:"5-modifica-el-androidmanifest",children:["5. ",(0,t.jsx)(e.strong,{children:"Modifica el AndroidManifest"})]}),"\n",(0,t.jsxs)(e.p,{children:["Para que la actividad que arranque la aplicaci\xf3n sea la ",(0,t.jsx)(e.code,{children:"RegistroActivity"})," deberemos modificar el archivo ",(0,t.jsx)(e.code,{children:"AndroidManifest.xml"}),". Debe quedarte algo similar a esto."]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-xml",metastring:'title="AndroidManifest.xml"',children:'<?xml version="1.0" encoding="utf-8"?>\r\n<manifest xmlns:android="http://schemas.android.com/apk/res/android"\r\n    xmlns:tools="http://schemas.android.com/tools">\r\n\r\n    <application\r\n        android:allowBackup="true"\r\n        android:dataExtractionRules="@xml/data_extraction_rules"\r\n        android:fullBackupContent="@xml/backup_rules"\r\n        android:icon="@mipmap/ic_launcher"\r\n        android:label="@string/app_name"\r\n        android:roundIcon="@mipmap/ic_launcher_round"\r\n        android:supportsRtl="true"\r\n        android:theme="@style/Theme.AutenticacionDemo"\r\n        tools:targetApi="31">\r\n        <activity\r\n            android:name=".RegistroActivity"\r\n            android:exported="true">\r\n            // highlight-start\r\n            <intent-filter>\r\n                <action android:name="android.intent.action.MAIN" />\r\n                <category android:name="android.intent.category.LAUNCHER" />\r\n            </intent-filter>\r\n             // highlight-end\r\n        </activity>\r\n        <activity\r\n            android:name=".MainActivity"\r\n            android:exported="true">\r\n        </activity>\r\n    </application>\r\n\r\n</manifest>\n'})}),"\n",(0,t.jsx)(e.admonition,{title:"Intent-filter",type:"warning",children:(0,t.jsxs)(e.p,{children:["Aseg\xfarate que la etiqueta ",(0,t.jsx)(e.code,{children:"<intent-filter>"})," con el ",(0,t.jsx)(e.code,{children:"action MAIN"})," y ",(0,t.jsx)(e.code,{children:"category LAUNCHER"})," este dentro de la actividad de registro."]})}),"\n",(0,t.jsx)(e.h2,{id:"prueba-la-aplicaci\xf3n",children:(0,t.jsx)(e.strong,{children:"Prueba la aplicaci\xf3n"})}),"\n",(0,t.jsx)(e.p,{children:"Felicidades \ud83d\udc4f\ud83c\udffd\ud83d\udc4f\ud83c\udffd. En este punto deber\xedas tener una App que permita el login y registro de usuarios. Ahora a\xf1adiremos nuevas funcionalidades \ud83d\ude80"})]})}function u(n={}){const{wrapper:e}={...(0,a.R)(),...n.components};return e?(0,t.jsx)(e,{...n,children:(0,t.jsx)(c,{...n})}):c(n)}},35225:(n,e,r)=>{r.d(e,{A:()=>i});const i=r.p+"assets/images/Autenticacion_v1-68b08e4e8abf71d4170f6e79660a0ee5.gif"},28453:(n,e,r)=>{r.d(e,{R:()=>o,x:()=>s});var i=r(96540);const t={},a=i.createContext(t);function o(n){const e=i.useContext(a);return i.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function s(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(t):n.components||t:o(n.components),i.createElement(a.Provider,{value:e},n.children)}}}]);