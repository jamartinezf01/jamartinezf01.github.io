<!doctype html>
<html lang="es" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-salva/aplicaciones mÃ³viles/5 Persistencia/Room/5.3.3 Base de Datos" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">5.3.3 BBDD (@Database) | Apuntes de InformÃ¡tica</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://jamartinezf01.github.io/docs/salva/aplicaciones mÃ³viles/5 Persistencia/Room/5.3.3 Base de Datos"><meta data-rh="true" property="og:locale" content="es"><meta data-rh="true" name="docusaurus_locale" content="es"><meta data-rh="true" name="docsearch:language" content="es"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="5.3.3 BBDD (@Database) | Apuntes de InformÃ¡tica"><meta data-rh="true" name="description" content="La clase de Base de Datos en Room actÃºa como el punto de entrada principal para interactuar con la base de datos SQLite subyacente. Es responsable de definir las entidades, exponer los DAOs y manejar las operaciones de creaciÃ³n y migraciÃ³n de esquemas. ğŸ› ï¸"><meta data-rh="true" property="og:description" content="La clase de Base de Datos en Room actÃºa como el punto de entrada principal para interactuar con la base de datos SQLite subyacente. Es responsable de definir las entidades, exponer los DAOs y manejar las operaciones de creaciÃ³n y migraciÃ³n de esquemas. ğŸ› ï¸"><link data-rh="true" rel="icon" href="/img/logoJAMF.png"><link data-rh="true" rel="canonical" href="https://jamartinezf01.github.io/docs/salva/aplicaciones mÃ³viles/5 Persistencia/Room/5.3.3 Base de Datos"><link data-rh="true" rel="alternate" href="https://jamartinezf01.github.io/docs/salva/aplicaciones mÃ³viles/5 Persistencia/Room/5.3.3 Base de Datos" hreflang="es"><link data-rh="true" rel="alternate" href="https://jamartinezf01.github.io/docs/salva/aplicaciones mÃ³viles/5 Persistencia/Room/5.3.3 Base de Datos" hreflang="x-default"><meta httpequiv="Cache-Control" content="no-cache, no-store, must-revalidate">
<meta httpequiv="Pragma" content="no-cache">
<meta httpequiv="Expires" content="0">

<script src="/version.js"></script><link rel="stylesheet" href="/assets/css/styles.6fe1923d.css">
<script src="/assets/js/runtime~main.59c50b68.js" defer="defer"></script>
<script src="/assets/js/main.376d92f9.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Saltar al contenido principal"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Saltar al contenido principal</a></div><nav aria-label="Principal" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Alternar barra lateral" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><b class="navbar__title text--truncate">Inicio</b></a><a class="navbar__item navbar__link" href="/docs/lenguajes-de-marcas/IntroducciÃ³n">LLMM</a><a class="navbar__item navbar__link" href="/docs/python/IntroducciÃ³n">Python</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://informatica.iesalbarregas.com/login/index.php" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Moodle<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Cambiar entre modo oscuro y claro (actualmente system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Volver al principio" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><main class="docMainContainer_TBSr docMainContainerEnhanced_lQrH"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">En esta pÃ¡gina</button></div><div class="theme-doc-markdown markdown"><header><h1>5.3.3 BBDD (<code>@Database</code>)</h1></header>
<p>La clase de <strong>Base de Datos</strong> en Room actÃºa como el punto de entrada principal para interactuar con la base de datos SQLite subyacente. Es responsable de definir las entidades, exponer los DAOs y manejar las operaciones de creaciÃ³n y migraciÃ³n de esquemas. ğŸ› ï¸</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="quÃ©-es-una-base-de-datos-en-room-"><strong>Â¿QuÃ© es una Base de Datos en Room?</strong> ğŸ¤”<a href="#quÃ©-es-una-base-de-datos-en-room-" class="hash-link" aria-label="Enlace directo al quÃ©-es-una-base-de-datos-en-room-" title="Enlace directo al quÃ©-es-una-base-de-datos-en-room-">â€‹</a></h2>
<p>En Room, la base de datos es una clase abstracta que:<br>
<!-- -->1ï¸âƒ£ Extiende la clase <code>RoomDatabase</code>.<br>
<!-- -->2ï¸âƒ£ EstÃ¡ anotada con <code>@Database</code> para definir las entidades que contiene y su versiÃ³n.<br>
<!-- -->3ï¸âƒ£ Proporciona mÃ©todos abstractos que exponen los DAOs.</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="cÃ³mo-crear-una-base-de-datos-ï¸"><strong>CÃ³mo crear una Base de Datos</strong> ğŸ› ï¸<a href="#cÃ³mo-crear-una-base-de-datos-ï¸" class="hash-link" aria-label="Enlace directo al cÃ³mo-crear-una-base-de-datos-ï¸" title="Enlace directo al cÃ³mo-crear-una-base-de-datos-ï¸">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-anotar-la-clase-con-database">1. Anotar la clase con <code>@Database</code><a href="#1-anotar-la-clase-con-database" class="hash-link" aria-label="Enlace directo al 1-anotar-la-clase-con-database" title="Enlace directo al 1-anotar-la-clase-con-database">â€‹</a></h3>
<p>La anotaciÃ³n <code>@Database</code> especifica:</p>
<ul>
<li><strong>Las entidades que pertenecen a la base de datos</strong>.</li>
<li><strong>La versiÃ³n de la base de datos</strong>, que es necesaria para gestionar migraciones.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-extender-roomdatabase">2. Extender <code>RoomDatabase</code><a href="#2-extender-roomdatabase" class="hash-link" aria-label="Enlace directo al 2-extender-roomdatabase" title="Enlace directo al 2-extender-roomdatabase">â€‹</a></h3>
<p>La clase debe heredar de <code>RoomDatabase</code>, lo que permite a Room gestionar automÃ¡ticamente el acceso a los datos.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-proporcionar-mÃ©todos-para-los-daos">3. Proporcionar mÃ©todos para los DAOs<a href="#3-proporcionar-mÃ©todos-para-los-daos" class="hash-link" aria-label="Enlace directo al 3. Proporcionar mÃ©todos para los DAOs" title="Enlace directo al 3. Proporcionar mÃ©todos para los DAOs">â€‹</a></h3>
<p>Se define un mÃ©todo abstracto para cada DAO que se necesite en la base de datos.</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="ejemplo-completo-de-una-base-de-datos-"><strong>Ejemplo completo de una Base de Datos</strong> ğŸ“˜<a href="#ejemplo-completo-de-una-base-de-datos-" class="hash-link" aria-label="Enlace directo al ejemplo-completo-de-una-base-de-datos-" title="Enlace directo al ejemplo-completo-de-una-base-de-datos-">â€‹</a></h2>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token import namespace" style="opacity:0.7">androidx</span><span class="token import namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token import namespace" style="opacity:0.7">room</span><span class="token import namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token import class-name">Database</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token import namespace" style="opacity:0.7">androidx</span><span class="token import namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token import namespace" style="opacity:0.7">room</span><span class="token import namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token import class-name">RoomDatabase</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token annotation punctuation" style="color:#393A34">@Database</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">entities </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token class-name">User</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">class</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">Order</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">class</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> version </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">abstract</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">AppDatabase</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">extends</span><span class="token plain"> </span><span class="token class-name">RoomDatabase</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// MÃ©todo para acceder al UserDao</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">abstract</span><span class="token plain"> </span><span class="token class-name">UserDao</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">userDao</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// MÃ©todo para acceder al OrderDao</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">abstract</span><span class="token plain"> </span><span class="token class-name">OrderDao</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">orderDao</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p>En este ejemplo:</p>
<ul>
<li>La base de datos contiene dos entidades: <code>User</code> y <code>Order</code>.</li>
<li>Proporciona dos DAOs: <code>UserDao</code> y <code>OrderDao</code>.</li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="parÃ¡metros-de-la-anotaciÃ³n-database-"><strong>ParÃ¡metros de la anotaciÃ³n <code>@Database</code></strong> ğŸ“Š<a href="#parÃ¡metros-de-la-anotaciÃ³n-database-" class="hash-link" aria-label="Enlace directo al parÃ¡metros-de-la-anotaciÃ³n-database-" title="Enlace directo al parÃ¡metros-de-la-anotaciÃ³n-database-">â€‹</a></h2>
<table><thead><tr><th>ParÃ¡metro</th><th>DescripciÃ³n</th></tr></thead><tbody><tr><td><code>entities</code></td><td>Lista de clases que representan las tablas de la base de datos.</td></tr><tr><td><code>version</code></td><td>VersiÃ³n del esquema de la base de datos. Se incrementa cuando cambian las entidades.</td></tr><tr><td><code>exportSchema</code></td><td>Si se establece en <code>true</code>, exporta el esquema de la base de datos a un archivo JSON.</td></tr></tbody></table>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="inicializaciÃ³n-de-la-base-de-datos-"><strong>InicializaciÃ³n de la Base de Datos</strong> ğŸš€<a href="#inicializaciÃ³n-de-la-base-de-datos-" class="hash-link" aria-label="Enlace directo al inicializaciÃ³n-de-la-base-de-datos-" title="Enlace directo al inicializaciÃ³n-de-la-base-de-datos-">â€‹</a></h2>
<p>Room proporciona un mÃ©todo <code>Room.databaseBuilder</code> para crear una instancia de la base de datos.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ejemplo-bÃ¡sico">Ejemplo bÃ¡sico<a href="#ejemplo-bÃ¡sico" class="hash-link" aria-label="Enlace directo al Ejemplo bÃ¡sico" title="Enlace directo al Ejemplo bÃ¡sico">â€‹</a></h3>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token import namespace" style="opacity:0.7">android</span><span class="token import namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token import namespace" style="opacity:0.7">content</span><span class="token import namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token import class-name">Context</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token import namespace" style="opacity:0.7">androidx</span><span class="token import namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token import namespace" style="opacity:0.7">room</span><span class="token import namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token import class-name">Room</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">DatabaseClient</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token class-name">DatabaseClient</span><span class="token plain"> instance</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">final</span><span class="token plain"> </span><span class="token class-name">AppDatabase</span><span class="token plain"> appDatabase</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> </span><span class="token class-name">DatabaseClient</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Context</span><span class="token plain"> context</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        appDatabase </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">Room</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">databaseBuilder</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getApplicationContext</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token class-name">AppDatabase</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">class</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string" style="color:#e3116c">&quot;my_database&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">build</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">synchronized</span><span class="token plain"> </span><span class="token class-name">DatabaseClient</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getInstance</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Context</span><span class="token plain"> context</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">instance </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            instance </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">DatabaseClient</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">context</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> instance</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token class-name">AppDatabase</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getAppDatabase</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> appDatabase</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="gestiÃ³n-del-esquema-con-version-ï¸"><strong>GestiÃ³n del esquema con <code>version</code></strong> âš™ï¸<a href="#gestiÃ³n-del-esquema-con-version-ï¸" class="hash-link" aria-label="Enlace directo al gestiÃ³n-del-esquema-con-version-ï¸" title="Enlace directo al gestiÃ³n-del-esquema-con-version-ï¸">â€‹</a></h2>
<p>Cada vez que realices cambios en el esquema (por ejemplo, agregar una columna), debes incrementar el nÃºmero de versiÃ³n y manejar la migraciÃ³n.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ejemplo-de-migraciÃ³n">Ejemplo de migraciÃ³n<a href="#ejemplo-de-migraciÃ³n" class="hash-link" aria-label="Enlace directo al Ejemplo de migraciÃ³n" title="Enlace directo al Ejemplo de migraciÃ³n">â€‹</a></h3>
<p>Imagina que en la versiÃ³n 2 quieres agregar una nueva columna <code>age</code> a la tabla <code>users</code>.</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">final</span><span class="token plain"> </span><span class="token class-name">Migration</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">MIGRATION_1_2</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Migration</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token annotation punctuation" style="color:#393A34">@Override</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">migrate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">SupportSQLiteDatabase</span><span class="token plain"> database</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        database</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">execSQL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;ALTER TABLE users ADD COLUMN age INTEGER&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<p>Al construir la base de datos, registra la migraciÃ³n:</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token class-name">Room</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">databaseBuilder</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">context</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">AppDatabase</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">class</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;my_database&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">addMigrations</span><span class="token punctuation" style="color:#393A34">(</span><span class="token constant" style="color:#36acaa">MIGRATION_1_2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">build</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="integraciÃ³n-con-singletons-"><strong>IntegraciÃ³n con Singletons</strong> ğŸ§©<a href="#integraciÃ³n-con-singletons-" class="hash-link" aria-label="Enlace directo al integraciÃ³n-con-singletons-" title="Enlace directo al integraciÃ³n-con-singletons-">â€‹</a></h2>
<p>Es comÃºn que la base de datos se inicialice como un <strong>Singleton</strong> para evitar mÃºltiples instancias en el proyecto.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="patrÃ³n-singleton">PatrÃ³n Singleton<a href="#patrÃ³n-singleton" class="hash-link" aria-label="Enlace directo al PatrÃ³n Singleton" title="Enlace directo al PatrÃ³n Singleton">â€‹</a></h3>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">DatabaseInstance</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token class-name">AppDatabase</span><span class="token plain"> instance</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">synchronized</span><span class="token plain"> </span><span class="token class-name">AppDatabase</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getDatabase</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Context</span><span class="token plain"> context</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">instance </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            instance </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">Room</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">databaseBuilder</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getApplicationContext</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token class-name">AppDatabase</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">class</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token string" style="color:#e3116c">&quot;app_database&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">build</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> instance</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="buenas-prÃ¡cticas-"><strong>Buenas prÃ¡cticas</strong> âœ…<a href="#buenas-prÃ¡cticas-" class="hash-link" aria-label="Enlace directo al buenas-prÃ¡cticas-" title="Enlace directo al buenas-prÃ¡cticas-">â€‹</a></h2>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Sigue estos consejos...</div><div class="admonitionContent_BuS1"><p>1ï¸âƒ£ <strong>Evita operaciones en el hilo principal</strong>:<br>
<!-- -->Room no permite consultas en el hilo principal por defecto. Usa coroutines o un hilo separado para las operaciones de base de datos.</p><p>2ï¸âƒ£ <strong>Manejo adecuado de migraciones</strong>:<br>
<!-- -->Siempre incrementa el nÃºmero de versiÃ³n y proporciona migraciones al realizar cambios en el esquema.</p><p>3ï¸âƒ£ <strong>Singleton para la base de datos</strong>:<br>
<!-- -->AsegÃºrate de usar una Ãºnica instancia de la base de datos para evitar bloqueos y mejorar el rendimiento.</p></div></div>
<hr></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="PÃ¡gina del documento"></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#quÃ©-es-una-base-de-datos-en-room-" class="table-of-contents__link toc-highlight"><strong>Â¿QuÃ© es una Base de Datos en Room?</strong> ğŸ¤”</a></li><li><a href="#cÃ³mo-crear-una-base-de-datos-ï¸" class="table-of-contents__link toc-highlight"><strong>CÃ³mo crear una Base de Datos</strong> ğŸ› ï¸</a><ul><li><a href="#1-anotar-la-clase-con-database" class="table-of-contents__link toc-highlight">1. Anotar la clase con <code>@Database</code></a></li><li><a href="#2-extender-roomdatabase" class="table-of-contents__link toc-highlight">2. Extender <code>RoomDatabase</code></a></li><li><a href="#3-proporcionar-mÃ©todos-para-los-daos" class="table-of-contents__link toc-highlight">3. Proporcionar mÃ©todos para los DAOs</a></li></ul></li><li><a href="#ejemplo-completo-de-una-base-de-datos-" class="table-of-contents__link toc-highlight"><strong>Ejemplo completo de una Base de Datos</strong> ğŸ“˜</a></li><li><a href="#parÃ¡metros-de-la-anotaciÃ³n-database-" class="table-of-contents__link toc-highlight"><strong>ParÃ¡metros de la anotaciÃ³n <code>@Database</code></strong> ğŸ“Š</a></li><li><a href="#inicializaciÃ³n-de-la-base-de-datos-" class="table-of-contents__link toc-highlight"><strong>InicializaciÃ³n de la Base de Datos</strong> ğŸš€</a><ul><li><a href="#ejemplo-bÃ¡sico" class="table-of-contents__link toc-highlight">Ejemplo bÃ¡sico</a></li></ul></li><li><a href="#gestiÃ³n-del-esquema-con-version-ï¸" class="table-of-contents__link toc-highlight"><strong>GestiÃ³n del esquema con <code>version</code></strong> âš™ï¸</a><ul><li><a href="#ejemplo-de-migraciÃ³n" class="table-of-contents__link toc-highlight">Ejemplo de migraciÃ³n</a></li></ul></li><li><a href="#integraciÃ³n-con-singletons-" class="table-of-contents__link toc-highlight"><strong>IntegraciÃ³n con Singletons</strong> ğŸ§©</a><ul><li><a href="#patrÃ³n-singleton" class="table-of-contents__link toc-highlight">PatrÃ³n Singleton</a></li></ul></li><li><a href="#buenas-prÃ¡cticas-" class="table-of-contents__link toc-highlight"><strong>Buenas prÃ¡cticas</strong> âœ…</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright"><p xmlns:cc="http://creativecommons.org/ns#" xmlns:dct="http://purl.org/dc/terms/"><a property="dct:title" rel="cc:attributionURL" href="https://jamfdev.github.io/">Apuntes para Ciclos Formativos de FormaciÃ³n Profesional</a> por <span property="cc:attributionName">Jose A. MartÃ­nez</span>  <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/?ref=chooser-v1" target="_blank" rel="license noopener noreferrer" style="display:inline-block;">CC BY-NC-SA 4.0<img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1" alt=""><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1" alt=""><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/nc.svg?ref=chooser-v1" alt=""><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/sa.svg?ref=chooser-v1" alt=""></a></p> 
        <p>ğŸ“§ jamartinezf01@iesalbarregas.es</p></div></div></div></footer></div>
</body>
</html>